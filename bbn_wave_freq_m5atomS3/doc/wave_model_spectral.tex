\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm} % Enhanced math packages
\usepackage{graphicx} % For including figures
\usepackage{caption, subcaption} % For figure captions
\usepackage{geometry} % For page margins
\usepackage{setspace} % For line spacing
\usepackage{lipsum} % For placeholder text, remove in final draft
\usepackage{booktabs} % For better tables
\usepackage{multirow} % For multirow tables
\usepackage{hyperref} % For hyperlinks
\usepackage{cite} % For citations
\usepackage{siunitx} % For SI units
\usepackage{float} % For better figure placement
\usepackage{titlesec} % For customizing section titles
\usepackage{chngcntr} % For continuous figure numbering
\counterwithout{figure}{section} % Figures numbered continuously
\counterwithout{table}{section} % Tables numbered continuously

\geometry{a4paper, margin=1in}
\onehalfspacing % 1.5 line spacing

% Custom section title formatting
\titleformat{\section}{\Large\bfseries}{\thesection.}{0.5em}{}
\titleformat{\subsection}{\large\bfseries}{\thesubsection.}{0.5em}{}
\titleformat{\subsubsection}{\bfseries}{\thesubsubsection.}{0.5em}{}

\title{Statistical Models of the Sea Surface: Historical Development, Theoretical Foundations, and Modern Applications}
\author{Deepseek AI with prompts by Mikhail Grushinskiy}
\date{\today}

\begin{document}

\maketitle

\begin{abstract}
This comprehensive review delves into the statistical models developed to describe the ocean surface, a critical endeavor for oceanography, coastal engineering, and climate science. We trace the historical evolution from early descriptive statistics to sophisticated spectral energy models. The theoretical foundations are explored in depth, including the rigorous derivation of the Gaussian sea surface model, the concept of the amplitude envelope via the Hilbert transform as pioneered by Michael S. Longuet-Higgins, and the nonlinear energy transfer theories of Klaus Hasselmann. The seminal parametric spectra—Pierson-Moskowitz, JONSWAP, and their derivatives—are derived and contrasted. A significant portion is dedicated to the practical application of these theories in modern wave measurement systems, detailing how buoys and other in-situ instruments measure, process, and translate raw time-series data (e.g., heave acceleration) into spectral estimates and bulk parameters like significant wave height ($H_s$), mean period ($T_z$), and peak period ($T_p$). The relationships between various statistical distributions (Rayleigh for wave heights, Gaussian for surface elevation) and their dependence on the underlying energy spectrum are thoroughly examined. This synthesis of theory, history, and practice provides a holistic understanding of how we mathematically characterize and empirically measure the dynamic ocean surface.
\end{abstract}

\tableofcontents
\newpage

\section{Introduction}
\subsection{The Importance of Ocean Wave Modeling}
The ocean surface is one of the most dynamic and complex interfaces on Earth. Understanding and predicting its behavior is not merely an academic pursuit but a practical necessity. Reliable wave models are indispensable for:
\begin{itemize}
    \item \textbf{Safe Marine Navigation:} Avoiding catastrophic damage to vessels and offshore structures from extreme waves (rogue waves).
    \item \textbf{Coastal Engineering:} Designing harbors, breakwaters, and seawalls that can withstand wave forces and prevent erosion.
    \item \textbf{Climate Science:} Quantifying air-sea interaction processes, which govern the exchange of momentum, heat, and gases (e.g., CO$_2$) between the ocean and atmosphere.
    \item \textbf{Renewable Energy:} Siting and operating wave and offshore wind energy converters.
\end{itemize}
Given the chaotic nature of the sea, a deterministic description of every wave is impossible. Instead, the field has matured by treating the sea surface as a stochastic process, allowing its properties to be described statistically and probabilistically.

\subsection{The Stochastic Framework}
The core assumption underpinning most classical wave models is that for short periods (on the order of hours), the sea surface can be considered a \textit{stationary} and \textit{ergodic} Gaussian random process. This powerful assumption allows us to use a single, long time-series to infer the statistical properties of the entire process. This review will explore the genesis, implications, and applications of this framework.

\section{Historical Context and Evolution of Thought}
\subsection{Early Observations and Descriptive Statistics}
The scientific study of waves began with careful observation. Early oceanographers like Vaughan Cornish meticulously recorded wave heights and periods, compiling empirical statistics. The concept of "significant wave height" ($H_s$ or $H_{1/3}$) emerged from this era, defined as the average height of the highest one-third of waves in a record. This parameter was found to correspond well with the wave height estimated by a trained human observer, hence "significant." This time-domain approach was practical but lacked a deep theoretical basis.

\subsection{The Spectral Revolution: Barber, Ursell, and Longuet-Higgins}
A paradigm shift occurred in the mid-20th century with the application of communication and signal processing theory to oceanography. The key insight was that an irregular sea state could be represented as a linear superposition of an infinite number of independent, regular harmonic wave components, each with its own amplitude, frequency, and direction. The distribution of energy among these components is described by the \textit{wave energy spectrum} $S(f, \theta)$, where $f$ is frequency and $\theta$ is direction.

Pioneering work by Barber, Ursell, and Longuet-Higgins in the 1940s and 1950s established this spectral description as the fundamental tool of wave analysis. This shifted the focus from individual waves in the time domain to the energy distribution in the frequency domain.

\subsection{The Gaussian Sea and Central Limit Theorem}
The linear superposition model naturally leads to a Gaussian distribution of the sea surface elevation, $\eta(t)$, by virtue of the Central Limit Theorem. If the phases of the individual wave components are random and independent, the sum of a large number of them will be Gaussian. This is a cornerstone of classical wave theory.

\subsection{Parametric Spectra: Pierson-Moskowitz and JONSWAP}
While the concept of a spectrum is powerful, it is data-intensive. A major advancement was the development of \textit{parametric spectra}—models whose shape is determined by a few key parameters like wind speed or wave age. The Pierson-Moskowitz (1964) spectrum for a "fully developed" sea and the JONSWAP (1973) spectrum for a "fetch-limited" growing sea are the two most famous examples, born from extensive measurement campaigns.

\subsection{Nonlinear Theories and Beyond}
The linear Gaussian model, while incredibly useful, has limitations. It cannot explain phenomena like rogue waves or the slow evolution of the spectrum in the open ocean. Klaus Hasselmann's work in the 1960s demonstrated that weak nonlinear resonant interactions between wave quadruplets were responsible for this energy transfer. This introduced a new level of complexity, showing that the phases of wave components are not entirely random but can be correlated through nonlinear processes.

\section{Theoretical Foundations: From Time Series to Spectra}
\subsection{The Gaussian Sea Surface Model}
We begin by assuming the sea surface elevation $\eta(t)$ at a point is a stationary, Gaussian random process with zero mean ($E[\eta(t)] = 0$). It can be represented as a Fourier-Stieltjes integral:
\begin{equation}
\eta(t) = \Re \left\{ \int_{0}^{\infty} e^{i(2\pi ft + \phi(f))}  dA(f) \right\}
\end{equation}
where $dA(f)$ is a complex amplitude and $\phi(f)$ is a random phase uniformly distributed on $[0, 2\pi)$.

The key statistical property is the \textit{autocorrelation function}:
\begin{equation}
R(\tau) = E[\eta(t)\eta(t+\tau)]
\end{equation}
For a stationary process, $R(\tau)$ depends only on the time lag $\tau$. The \textit{Wiener-Khinchin theorem} states that the power spectral density $S(f)$ is the Fourier transform of the autocorrelation function:
\begin{equation}
S(f) = \int_{-\infty}^{\infty} R(\tau) e^{-i2\pi f\tau}  d\tau, \quad \text{and conversely} \quad R(\tau) = \int_{-\infty}^{\infty} S(f) e^{i2\pi f\tau}  df
\end{equation}
The variance of the process, $\sigma^2 = E[\eta^2(t)]$, is given by the total area under the spectrum:
\begin{equation}
\sigma^2 = R(0) = \int_{0}^{\infty} S(f)  df = m_0
\end{equation}
This quantity, $m_0$, is the zeroth moment of the spectrum and is fundamental to wave statistics.

\subsection{Defining Wave Amplitudes: The Envelope Concept}
\label{sec:envelope}
While $\eta(t)$ is Gaussian, the properties of individual waves (crest-to-trough height, period) are not directly given by $S(f)$. Longuet-Higgins (1952) revolutionized the analysis by applying the concept of the \textit{analytic signal} and \textit{envelope} from communication theory.

For a narrow-band signal $\eta(t)$, one can define its Hilbert transform:
\begin{equation}
\hat{\eta}(t) = \frac{1}{\pi} \mathcal{P} \int_{-\infty}^{\infty} \frac{\eta(\tau)}{t - \tau}  d\tau
\end{equation}
where $\mathcal{P}$ denotes the Cauchy principal value. The analytic signal $z(t)$ is then:
\begin{equation}
z(t) = \eta(t) + i\hat{\eta}(t) = a(t)e^{i\Phi(t)}
\end{equation}
From this, we define the \textit{amplitude envelope} $a(t)$ and the \textit{instantaneous phase} $\Phi(t)$:
\begin{align}
a(t) &= \sqrt{\eta^2(t) + \hat{\eta}^2(t)} \\
\Phi(t) &= \arctan\left(\frac{\hat{\eta}(t)}{\eta(t)}\right)
\end{align}
For a narrow-band Gaussian process, Longuet-Higgins showed that the envelope $a(t)$ follows a \textit{Rayleigh distribution}:
\begin{equation}
p(a) = \frac{a}{m_0} \exp\left( -\frac{a^2}{2m_0} \right), \quad a \geq 0
\end{equation}

\subsection{From Envelope to Wave Heights}
A "wave" is defined by the portion of the signal between two successive zero-upcrossings. For a narrow-band process, the wave height $H$ is approximately twice the value of the envelope at the wave crest. Using the Rayleigh distribution for the envelope amplitudes, the probability distribution for wave heights is also Rayleigh:
\begin{equation}
p(H) = \frac{H}{4m_0} \exp\left( -\frac{H^2}{8m_0} \right)
\end{equation}
From this distribution, we can derive the significant wave height $H_s$ (the mean of the highest 1/3 of waves). It is found by integrating the tail of the Rayleigh distribution:
\begin{equation}
H_s = H_{1/3} = 4.004 \sqrt{m_0} \approx 4\sqrt{m_0}
\end{equation}
This is a crucial result, providing a direct link between the frequency-domain statistic ($m_0$, derived from the spectrum) and the time-domain statistic ($H_s$). Other important statistical heights are:
\begin{align}
H_{\text{avg}} &= \sqrt{2\pi m_0} \approx 2.5\sqrt{m_0} \quad &\text{(Average wave height)} \\
H_{\text{rms}} &= 2\sqrt{2m_0} \approx 2.83\sqrt{m_0} \quad &\text{(Root-mean-square wave height)}
\end{align}

\section{The Parametric Wave Spectra Models}
\subsection{The Pierson-Moskowitz (PM) Spectrum}
Pierson and Moskowitz analyzed wave data from the North Atlantic to develop a spectrum for a sea state that is in equilibrium with the wind. They found the spectrum's shape depended primarily on the wind speed $U$.\newpage

\noindent They proposed the following form:
\begin{equation}
S_{\text{PM}}(f) = \alpha g^2 (2\pi)^{-4} f^{-5} \exp\left[ -\frac{5}{4} \left( \frac{f}{f_p} \right)^{-4} \right]
\end{equation}
where:
\begin{itemize}
    \item $\alpha = 8.1 \times 10^{-3}$ is Phillips' constant, a dimensionless parameter.
    \item $g$ is acceleration due to gravity.
    \item $f_p$ is the peak frequency, the frequency where the spectrum is maximum.
\end{itemize}
Based on their data, they found the peak frequency is related to the wind speed $U$ at 19.5 m above sea level by:
\begin{equation}
f_p = \frac{0.877 g}{2\pi U}
\end{equation}
Substituting this into the spectrum yields a form solely dependent on $U$. The significant wave height for a PM spectrum can be derived from its zeroth moment:
\begin{equation}
H_s = 4\sqrt{m_0} = 4 \sqrt{ \int_0^{\infty} S_{\text{PM}}(f)  df } = \frac{0.21 U^2}{g}
\end{equation}
This shows that in a fully developed sea, $H_s$ grows proportionally to $U^2$.

\subsection{The JONSWAP Spectrum}
The Joint North Sea Wave Project found that waves in developing sea states (fetch-limited) had spectra that were much sharper (more "peaky") around the peak frequency than the PM spectrum. The JONSWAP spectrum is a modification of the PM form with a peak enhancement factor $\gamma$:
\begin{equation}
S_{\text{J}}(f) = S_{\text{PM}}(f) \cdot \gamma^{\exp\left( -\frac{(f - f_p)^2}{2\sigma^2 f_p^2} \right)}
\end{equation}
where:
\begin{itemize}
    \item $S_{\text{PM}}(f)$ is the Pierson-Moskowitz form.
    \item $\gamma$ is the peak enhancement factor (typically $\gamma=3.3$ for the North Sea, range $1 \leq \gamma \leq 7$).
    \item $\sigma$ is the spectral width parameter: $\sigma = \sigma_a = 0.07$ for $f \leq f_p$ and $\sigma = \sigma_b = 0.09$ for $f > f_p$.
\end{itemize}
The JONSWAP study also found that the spectrum was not fully developed and that its parameters depended on the fetch $X$ (the distance over which the wind blows):
\begin{align}
f_p &= 3.5 \left( \frac{gX}{U^2} \right)^{-0.33} \\
\alpha &= 0.076 \left( \frac{gX}{U^2} \right)^{-0.22}
\end{align}
The JONSWAP spectrum is far more flexible and accurately represents a wider range of sea states encountered in practice, particularly those still under the influence of the wind.

\section{Modern Wave Measurement: The Buoy System}
\subsection{The Measurement Chain}
A typical directional wave buoy contains:
\begin{enumerate}
    \item \textbf{Inertial Measurement Unit (IMU):} Contains accelerometers and gyroscopes to measure the buoy's heave, surge, sway, pitch, and roll.
    \item \textbf{Fluxgate Compass:} Measures heading.
    \item \textbf{GPS Receiver:} Provides precise location and time.
\end{enumerate}
The primary measurement for wave statistics is \textit{heave acceleration}, $a_z(t)$.

\subsection{From Acceleration to Elevation}
The raw accelerometer data cannot be used directly; it must be processed.
\begin{enumerate}
    \item \textbf{Despiking and Filtering:} Remove spurious data points and high-frequency noise.
    \item \textbf{Coordinate Transformation:} The measured acceleration is in the buoy's frame of reference. Using pitch, roll, and heading data, this is transformed to the Earth-fixed horizontal (East-North) and vertical (Up) coordinate system. This corrects for the buoy's tilt.
    \item \textbf{Double Integration:} To derive surface displacement $\eta(t)$ from vertical acceleration $a_z(t)$:
    \begin{equation}
    \eta(t) = \iint a_z(t)  dt  dt
    \end{equation}
    Direct integration amplifies low-frequency noise exponentially (a process known as "integration drift"). This is solved by:
    \item \textbf{High-Pass Filtering:} A very sharp high-pass filter is applied to the integrated signal to remove the low-frequency drift without affecting the wave frequencies of interest. This yields a stable time-series of $\eta(t)$.
\end{enumerate}

\subsection{From Elevation to Spectrum}
The cleaned $\eta(t)$ time-series is processed to obtain the wave spectrum $S(f)$.
\begin{enumerate}
    \item \textbf{Segmentation:} The time series is divided into multiple segments (e.g., 20-30 minutes each), often with 50\% overlap.
    \item \textbf{Detrending:} A linear trend is removed from each segment to ensure stationarity.
    \item \textbf{Tapering:} Each segment is multiplied by a window function (e.g., a Hanning window) to minimize spectral "leakage".
    \item \textbf{Fast Fourier Transform (FFT):} The FFT algorithm is applied to each tapered segment to compute a \textit{periodogram}, a raw estimate of the power spectral density for that segment.
    \item \textbf{Ensemble Averaging:} The periodograms from all segments are averaged together to produce a smooth, final estimate of $S(f)$. This averaging reduces the variance of the spectral estimate.
    \item \textbf{Directional Spectrum:} To obtain the directional spectrum $S(f, \theta)$, buoys use the measured horizontal accelerations and slopes. By comparing the phase difference between heave motion and horizontal acceleration (or slope), the direction from which waves at each frequency are coming can be estimated. This is often done using methods like the \textit{Extended Maximum Entropy Principle (EMEP)} or \textit{Maximum Likelihood Method (MLM)}.
\end{enumerate}

\subsection{Deriving Bulk Parameters}
The final spectral estimate $S(f)$ is used to calculate the spectral moments:
\begin{equation}
m_n = \int_{0}^{\infty} f^n S(f)  df, \quad \text{for } n = 0, 1, 2, ...
\end{equation}
From these moments, all common bulk parameters are derived:
\begin{align}
H_s &= 4\sqrt{m_0} \\
T_z &= T_{02} = \sqrt{\frac{m_0}{m_2}} \quad &\text{(Average zero-upcrossing period)} \\
T_p &= \frac{1}{f_p} \quad &\text{(Peak period, from the frequency at max(S(f)))} \\
T_{01} &= \frac{m_0}{m_1} \quad &\text{(Mean period)}
\end{align}
This entire process, from measuring acceleration to publishing $H_s$ and $T_p$, is automated on modern data buoys, providing near-real-time wave data to users worldwide.

\section{Relationships Between Distributions}
The statistical description of the sea surface is hierarchical, with the energy spectrum $S(f)$ as the fundamental quantity.
\begin{itemize}
    \item \textbf{Surface Elevation:} $\eta(t)$ is \textit{Gaussian} distributed, with variance $m_0$. $p(\eta) = \frac{1}{\sqrt{2\pi m_0}} \exp\left( -\frac{\eta^2}{2m_0} \right)$.
    \item \textbf{Wave Envelope:} For a narrow-band process, the envelope $a(t)$ is \textit{Rayleigh} distributed, $p(a) = \frac{a}{m_0} \exp\left( -\frac{a^2}{2m_0} \right)$.
    \item \textbf{Wave Heights:} For a narrow-band process, crest-to-trough wave heights $H$ are also \textit{Rayleigh} distributed, $p(H) = \frac{H}{4m_0} \exp\left( -\frac{H^2}{8m_0} \right)$.
    \item \textbf{Wave Crests:} In linear theory, crest heights follow the same distribution as the envelope (Rayleigh). However, in steep waves, nonlinear effects cause crests to be higher and troughs to be shallower than linear theory predicts. This is often modeled with second-order theory or distributions like the \textit{Forristall} distribution.
\end{itemize}
The validity of the Rayleigh distribution for wave heights depends on the \textit{bandwidth} of the spectrum. As the spectrum becomes broader ($e.g.,$ in mixed seas with both swell and wind-waves), the distribution of wave heights deviates from Rayleigh and is better described by a \textit{Weibull} or other distributions.

\section{Wave Partitioning in Ocean Wave Spectra}
\label{sec:wave-partitioning}

\subsection{Introduction and Motivation}
The ocean wave field is rarely composed of a single, homogeneous system. Instead, at any given location the observed surface elevation $\eta(t)$ can be regarded as the superposition of multiple stochastic wave trains generated by winds of different spatial and temporal scales. This leads to a directional frequency spectrum $S(f,\theta)$ that is multi-modal both in frequency $f$ and in direction $\theta$. 

The process of \emph{wave partitioning} is defined as the decomposition of the two-dimensional spectrum $S(f,\theta)$ into a finite number of distinct spectral components, or \emph{partitions}, each representing a physically coherent wave system (wind sea or swell). The decomposition problem can be formally written as
\[
S(f,\theta) = \sum_{k=1}^{N_p} S_k(f,\theta), 
\]
where $N_p$ is the number of partitions and $S_k(f,\theta)$ denotes the spectral density attributed to the $k$-th wave system.

Partitioning is essential because many oceanographic, engineering, and navigational applications require knowledge of not just the bulk wave parameters (e.g., total significant wave height $H_s$) but also of the individual systems that compose the sea state. For instance, ship routing must account differently for locally generated steep wind seas versus long-period swells originating from distant storms.

\subsection{Spectral Representation and Moments}
Let $\eta(t)$ denote the free surface elevation. Its variance is related to the spectral density by Parseval's theorem:
\[
\langle \eta^2 \rangle = \int_{0}^{\infty} \int_{0}^{2\pi} S(f,\theta) \, d\theta \, df.
\]
The \emph{zeroth spectral moment} is defined as
\[
m_0 = \int_{0}^{\infty} \int_{0}^{2\pi} S(f,\theta) \, d\theta \, df,
\]
and the significant wave height is estimated as
\[
H_s \approx 4 \sqrt{m_0}.
\]
Similarly, the $n$-th order frequency moment is
\[
m_n = \int_{0}^{\infty} \int_{0}^{2\pi} f^n S(f,\theta) \, d\theta \, df,
\]
from which characteristic wave periods such as the mean zero-crossing period $T_z = \sqrt{m_0/m_2}$ and mean energy period $T_{-10} = m_{-1}/m_0$ can be derived. When spectra are partitioned, each $S_k(f,\theta)$ contributes its own set of moments $m_{n,k}$, yielding partition-specific parameters.

\subsection{Historical Development}
Early wave models in the 1970s and 1980s (e.g., the first global spectral models) produced one-dimensional frequency spectra and bulk parameters. With the advent of directional buoys and global third-generation spectral models in the 1990s, it became evident that a single set of parameters could not represent the multi-modal sea state. 

\begin{itemize}
    \item The concept of separating \emph{wind sea} and \emph{swell} components dates back at least to the work of Pierson and Moskowitz (1964) and Hasselmann et al. (1973), though these were parametric spectra rather than algorithmic partitions.
    \item Watershed algorithms, inspired by image processing (Vincent and Soille, 1991), were first adapted to spectral partitioning in the mid-1990s.
    \item The steepest-ascent (hill climbing) approach was introduced in operational wave modeling in the early 2000s, notably in WAVEWATCH~III.
    \item ECMWF developed hybrid approaches in the 2010s, adding temporal smoothing and heuristic merging rules to ensure stable partitions in reanalyses.
\end{itemize}

\subsection{Partitioning Algorithms: Theoretical Basis and Procedures}
Partitioning algorithms operate on a discrete spectral grid $S(f_i, \theta_j)$, with indices $i = 1,\dots,N_f$ and $j=1,\dots,N_\theta$. The objective is to group spectral bins into coherent partitions. Below we describe four main approaches.

\subsubsection{Watershed Partitioning}
\textbf{Theoretical basis:} The watershed transform views the energy surface $E(i,j) = S(f_i,\theta_j)$ as a digital elevation model. Local maxima are ``mountain peaks,'' and partitions correspond to drainage basins.

\textbf{Algorithm:}
\begin{enumerate}
    \item Identify all local maxima $(i_p,j_p)$ where $E(i_p,j_p) > E(i,j)$ for all neighbors $(i,j) \in \mathcal{N}(i_p,j_p)$.
    \item For each grid cell, simulate ``water flow'' by following the path of steepest descent until a maximum is reached.
    \item Assign the cell to the basin of that maximum.
    \item The set of basins $\{\mathcal{B}_k\}$ forms the partitions.
\end{enumerate}

\textbf{Formally:} Define the descent mapping $D:(i,j) \mapsto \arg\max_{(u,v) \in \mathcal{N}(i,j)} E(u,v)$. Iterating $D$ leads to a peak $(i_p,j_p)$. Then
\[
\mathcal{P}_k = \{ (i,j) : D^n(i,j) \to (i_p,j_p), \; \text{for some } n \}.
\]

\textbf{Properties:} 
\begin{itemize}
    \item Captures all local maxima, including small ones due to noise.
    \item Requires pre-smoothing to avoid spurious partitions.
\end{itemize}

\subsubsection{Hill Climbing (Steepest Ascent)}
\textbf{Theoretical basis:} Instead of ``flooding,'' each spectral bin ascends towards the nearest local maximum along the gradient of $E(i,j)$. 

\textbf{Algorithm:}
\begin{enumerate}
    \item Initialize from each spectral bin $(i,j)$ with $E(i,j) > \epsilon$, where $\epsilon$ is a noise threshold.
    \item At each step, move to the neighbor $(u,v)$ that maximizes $\Delta E = E(u,v) - E(i,j)$.
    \item Continue until no higher neighbor exists (a local maximum).
    \item Assign all visited bins to the partition associated with this maximum.
\end{enumerate}

\textbf{Mathematical description:} Let $(i_0,j_0)$ be the starting point. Define the iterative sequence
\[
(i_{n+1}, j_{n+1}) = \arg\max_{(u,v)\in\mathcal{N}(i_n,j_n)} E(u,v).
\]
Then the partition is
\[
\mathcal{P}_k = \{ (i,j): \lim_{n \to \infty} (i_n,j_n) = (i_p,j_p) \}.
\]

\textbf{Properties:}
\begin{itemize}
    \item Robust to smooth peaks.
    \item Sensitive to saddle points and noise.
\end{itemize}

\subsubsection{Energy- or Peak-Based Clustering}
\textbf{Theoretical basis:} Peaks are detected, and energy bins are assigned to the nearest peak in a metric space.

\textbf{Algorithm:}
\begin{enumerate}
    \item Detect peaks $\{(f_p,\theta_p)\}_{p=1}^M$ where $S(f,\theta)$ exceeds a fraction of the maximum energy.
    \item Define a distance metric, e.g.
    \[
    d((f,\theta),(f_p,\theta_p))^2 = \alpha (f-f_p)^2 + \beta \, \Delta\theta^2,
    \]
    with weights $\alpha, \beta$ balancing frequency and directional separation, and $\Delta\theta$ the angular difference.
    \item Assign each bin to the partition of the nearest peak: 
    \[
    \mathcal{P}_k = \{(f,\theta) : d((f,\theta),(f_k,\theta_k)) < d((f,\theta),(f_p,\theta_p)), \forall p\neq k \}.
    \]
\end{enumerate}

\textbf{Properties:}
\begin{itemize}
    \item Flexible, allows energy-based merging.
    \item Requires tuning of thresholds $\alpha,\beta$.
\end{itemize}

\subsubsection{Hybrid Approaches}
Hybrid approaches combine formal partitioning with heuristic rules. A typical hybrid method:
\begin{enumerate}
    \item Apply hill climbing to assign bins to peaks.
    \item Merge partitions closer than thresholds $\Delta f$ and $\Delta\theta$.
    \item Discard partitions with $H_s < H_{s,\min}$.
    \item Apply temporal continuity constraints by matching partitions across successive time steps to avoid ``jumping.''
\end{enumerate}

\textbf{Mathematically:} Define merging operator $\mathcal{M}$ and filtering operator $\mathcal{F}$. Then the final partition set is
\[
\{\mathcal{P}_k\}_{\text{final}} = \mathcal{F} \circ \mathcal{M} \circ \mathcal{A}(S),
\]
where $\mathcal{A}$ is the base algorithm (hill climbing or watershed).

\subsection{Directional Partitioning and System Separation}
Partitioning must be performed in two-dimensional frequency–direction space. Two systems may share the same frequency band but arrive from different directions. Therefore, $S(f,\theta)$ is discretized in both dimensions, and algorithms consider angular distance $\Delta\theta$ as well as frequency distance $\Delta f$. Crossing seas are identified by distinct maxima in different directional sectors.

\subsection{Implementations in Major Models}
\paragraph{WAVEWATCH~III (NOAA/NCEP).}
Operational since the early 2000s, WAVEWATCH~III uses a hill-climbing algorithm. The number of partitions is capped (typically 3--4), and weak partitions are discarded. The focus is on global robustness.

\paragraph{SWAN (Delft University).}
SWAN employs watershed partitioning, well-suited for coastal seas with complex spectra. Energy thresholds and smoothing prevent over-partitioning. Users may request many partitions if needed.

\paragraph{ECMWF IFS.}
ECMWF employs hybrid approaches since the 2010s, combining peak finding, watershed grouping, and heuristic merging. A maximum of 3--4 partitions are kept, with temporal continuity enforced. This yields smooth time series for reanalysis.

\subsection{Summary}
Wave partitioning is the mathematical and algorithmic decomposition of the directional spectrum into constituent systems. Theoretical frameworks range from image-processing analogies (watershed) to optimization (hill climbing, clustering) to hybrid heuristics. Operational implementations emphasize robustness, temporal continuity, and physical interpretability. This capability underpins modern marine forecasting and research, allowing not only bulk wave parameters but detailed separation of wind seas and swells.

\subsection{Construction of the Directional Wave Spectrum}
\label{subsec:directional-spectrum}

The sea surface elevation $\eta(t)$ is a stochastic process, and its variance can be represented in the frequency domain by the one-dimensional (1D) variance spectrum $S(f)$. The variance is obtained as
\begin{equation}
\langle \eta^2 \rangle = \int_{0}^{\infty} S(f) \, df,
\end{equation}
with units of $\mathrm{m}^2/\mathrm{Hz}$. The zeroth-order spectral moment is
\begin{equation}
m_0 = \int_{0}^{\infty} S(f)\, df,
\end{equation}
from which the significant wave height follows as
\begin{equation}
H_s \approx 4 \sqrt{m_0}.
\end{equation}

While $S(f)$ describes the distribution of variance across frequency, it does not contain any directional information. A complete description requires the \emph{directional spectrum}, denoted
\begin{equation}
S(f,\theta) = S(f) \, D(f,\theta),
\end{equation}
where $\theta$ is the wave direction and $D(f,\theta)$ is the \emph{directional spreading function}. By definition, $D(f,\theta)$ is normalized such that
\begin{equation}
\int_{0}^{2\pi} D(f,\theta)\, d\theta = 1, \qquad \forall f.
\end{equation}
The units of $S(f,\theta)$ are $\mathrm{m}^2 / (\mathrm{Hz}\cdot \mathrm{rad})$, and the full variance is recovered as
\begin{equation}
m_0 = \int_{0}^{\infty}\int_{0}^{2\pi} S(f,\theta)\, d\theta \, df.
\end{equation}

\paragraph{Common spreading models.}
Several forms of $D(f,\theta)$ are employed in practice:
\begin{itemize}
  \item \textbf{Cosine power model:}
  \begin{equation}
  D(f,\theta) = C_n \cos^{2n}\!\left(\tfrac{1}{2}(\theta - \theta_0)\right),
  \end{equation}
  where $\theta_0$ is the mean wave direction, $n$ controls the spread (larger $n$ gives narrower distribution), and $C_n$ is a normalization constant
  \begin{equation}
  C_n = \frac{\Gamma(n+1)}{\sqrt{\pi}\,\Gamma\!\left(n+\tfrac{1}{2}\right)}.
  \end{equation}

  \item \textbf{Mitsuyasu–Donelan frequency-dependent spreading:}
  \begin{equation}
  D(f,\theta) = \frac{2}{\pi} \cos^{2s(f)}\!\left(\tfrac{1}{2}(\theta - \theta_0)\right),
  \end{equation}
  with
  \begin{equation}
  s(f) = \alpha \left(\frac{f}{f_p}\right)^{-\beta},
  \end{equation}
  where $f_p$ is the spectral peak frequency and $(\alpha,\beta)$ are empirical constants, typically $\alpha \approx 11.5$, $\beta \approx 2.5$.

  \item \textbf{von Mises distribution (circular normal):}
  \begin{equation}
  D(f,\theta) = \frac{1}{2\pi I_0(\kappa)} \exp\!\left[\kappa \cos(\theta - \theta_0)\right],
  \end{equation}
  where $\kappa$ is the concentration parameter and $I_0$ is the modified Bessel function of the first kind of order zero. Small $\kappa$ yields isotropy, large $\kappa$ produces narrow spreading.
\end{itemize}

\paragraph{Construction procedure.}
The steps to construct $S(f,\theta)$ are:
\begin{enumerate}
  \item \textbf{Choose $S(f)$:} This may be obtained from field measurements (e.g. FFT of buoy time series) or from parametric spectra such as Pierson–Moskowitz or JONSWAP. For example, the JONSWAP spectrum is
  \begin{equation}
  S(f) = \alpha g^2 (2\pi)^{-4} f^{-5} \exp\!\left[-\tfrac{5}{4}\left(\tfrac{f_p}{f}\right)^4\right]
  \gamma^{\exp\!\left[-\tfrac{(f-f_p)^2}{2\sigma^2 f_p^2}\right]}.
  \end{equation}
  \item \textbf{Select mean direction $\theta_0(f)$:} For wind seas, this is aligned with the local wind. For swells, $\theta_0$ corresponds to the great-circle propagation from the storm source.
  \item \textbf{Choose spreading model $D(f,\theta)$:} Select an appropriate functional form (cosine power, Mitsuyasu–Donelan, von Mises) with parameters calibrated to observations.
  \item \textbf{Compute $S(f,\theta)$:} Multiply $S(f)$ by $D(f,\theta)$ over the grid $(f_i,\theta_j)$.
  \item \textbf{Verify normalization:} Ensure that $\int D(f,\theta)\,d\theta = 1$ at each $f$.
\end{enumerate}

\paragraph{Applications.}
The directional spectrum is the foundation of modern wave modeling and analysis:
\begin{itemize}
  \item \emph{Directional wave buoys} estimate $S(f,\theta)$ from heave–pitch–roll records via cross-spectral methods.
  \item \emph{Wave models} (e.g. WAVEWATCH~III, SWAN, ECMWF IFS) predict $S(f,\theta)$ on global and regional scales.
  \item \emph{Engineering applications} require $S(f,\theta)$ to compute directional wave forces on ships and offshore structures.
  \item \emph{Wave partitioning} algorithms (see Section~\ref{sec:wave-partitioning}) operate directly on $S(f,\theta)$ to separate multiple coexisting systems (wind sea and swells).
\end{itemize}
Thus, the construction of $S(f,\theta)$ from a 1D spectrum $S(f)$ and a spreading function $D(f,\theta)$ provides a rigorous, normalized framework to represent the multidirectional nature of ocean waves.

\subsection{Measuring the Directional Wave Spectrum}
\label{subsec:measure-directional-spectrum}

The \emph{directional spectrum} $S(f,\theta)$ (units: m$^2$/Hz/rad) distributes surface elevation variance by frequency $f$ and direction $\theta$. It satisfies
\begin{equation}
\int_{0}^{\infty}\int_{0}^{2\pi} S(f,\theta)\,d\theta\,df
= m_0, 
\qquad H_s \approx 4\sqrt{m_0},
\end{equation}
with $m_0$ the total variance. In practice, $S(f,\theta)$ is inferred from \emph{in situ} records (buoys, arrays) or remote sensors (HF/X-band radar, video, SAR) via cross-spectral analysis and inverse methods.

\paragraph{Notation.}
Let $\mathbf{x}(t) = [x_1(t),\ldots,x_M(t)]^\top$ be $M$ colocated or arrayed measurements (e.g., heave $\eta$, slopes or tilts, pressure $p$, velocities $u,v$). Over blocks assumed stationary and linear, form the $M\times M$ \emph{cross-spectral density} (CSD) matrix at frequency $f$:
\begin{equation}
\mathbf{C}(f) 
= \mathbb{E}\big[ \mathbf{X}(f)\mathbf{X}(f)^{\mathrm{H}} \big],
\qquad \mathbf{X}(f)=\mathcal{F}\{\mathbf{x}(t)\},
\end{equation}
estimated via Welch averaging (windowing, segment overlap). Degrees of freedom $\nu \approx 2K$ for $K$ averages provide confidence intervals.

\subsubsection{Heave--Pitch--Roll (HPR) / Triplet Buoys}
Directional wave buoys measure heave $\eta$, pitch $\pi$ and roll $\rho$ (or directly estimate surface slopes $\eta_x,\eta_y$). Under linear theory for a plane wave with wavenumber $\mathbf{k}=(k\cos\theta,k\sin\theta)$,
\begin{equation}
\eta_x \equiv \frac{\partial\eta}{\partial x} \approx k\cos\theta\,\eta, 
\qquad
\eta_y \equiv \frac{\partial\eta}{\partial y} \approx k\sin\theta\,\eta,
\end{equation}
with $k$ from the dispersion relation
\begin{equation}
\omega^2 = gk\tanh(kh), \qquad \omega=2\pi f,
\label{eq:dispersion}
\end{equation}
($h$ depth). The fundamental idea is that the \emph{first} and \emph{second} directional Fourier moments of $D(f,\theta)$,
\begin{equation}
R_n(f) = \int_{0}^{2\pi} D(f,\theta)\, e^{\mathrm{i}n\theta}\, d\theta 
= a_n(f) + \mathrm{i}\,b_n(f), \quad n=0,1,2,\ldots,
\qquad R_0\equiv1,
\end{equation}
can be related to normalized cross-spectra of $(\eta,\eta_x,\eta_y)$ (or proxies from pitch/roll).
A widely used set of estimators (Kuik--van~Vledder--Holthuijsen-type) is
\begin{align}
a_1(f) &= \frac{\Re\{ S_{\eta\,\eta_x}(f)\}}{k\,S_{\eta\eta}(f)},
&
b_1(f) &= \frac{\Re\{ S_{\eta\,\eta_y}(f)\}}{k\,S_{\eta\eta}(f)},
\\
a_2(f) &= \frac{S_{\eta_x\eta_x}(f) - S_{\eta_y\eta_y}(f)}{k^2\,S_{\eta\eta}(f)},
&
b_2(f) &= \frac{2\,\Re\{ S_{\eta_x\eta_y}(f)\}}{k^2\,S_{\eta\eta}(f)}.
\label{eq:a1b1a2b2}
\end{align}
From $(a_1,b_1)$ one obtains mean direction and first-order spread:
\begin{equation}
\bar{\theta}_1(f) = \mathrm{atan2}\!\big(b_1(f),a_1(f)\big), 
\qquad 
\sigma_\theta^{(1)}(f) \approx \sqrt{2\big(1-\sqrt{a_1^2+b_1^2}\big)}.
\end{equation}
Inverting to a nonnegative $D(f,\theta)$ uses truncated Fourier series with positivity constraints or entropy/likelihood estimators (below).

\emph{Implementation steps.} (i) Detrend, rotate to ENU axes, correct tilt-to-slope calibration; (ii) segment, window (e.g.\ Hanning), FFT; (iii) estimate $S_{\cdot\cdot}(f)$ and $k(f)$ by solving \eqref{eq:dispersion}; (iv) compute $a_1,b_1,a_2,b_2$ via \eqref{eq:a1b1a2b2}; (v) reconstruct $D(f,\theta)$ (e.g.\ Weighted Integral Method, MEM, MLM).

\subsubsection{PUV Tripods and Small Arrays}
Coastal tripods measure near-bed pressure $p$ and horizontal velocities $(u,v)$. Linear transfer functions relate these to surface elevation at frequency $f$:
\begin{align}
\eta &\approx \frac{p}{\rho g}\,\frac{\cosh(kh)}{\cosh\big(k(z+h)\big)},
&
u + \mathrm{i}v &\approx \frac{\omega}{k}\,\eta\,\frac{\cosh\big(k(z+h)\big)}{\sinh(kh)}\,e^{\mathrm{i}\theta},
\end{align}
with sensor elevation $z<0$. After correcting $p,u,v$ to $\eta,\eta_x,\eta_y$, proceed as in HPR. For \emph{spatial} arrays of $N$ sensors at positions $\{\mathbf{r}_m\}$, the steering (array response) for direction $\theta$ is
\begin{equation}
\mathbf{a}(\theta;f) = 
\big[e^{-\mathrm{i}\,\mathbf{k}(\theta)\cdot\mathbf{r}_1},\ldots,
e^{-\mathrm{i}\,\mathbf{k}(\theta)\cdot\mathbf{r}_N}\big]^\top,
\qquad \|\mathbf{k}(\theta)\|=k(f).
\end{equation}
This enables likelihood/beamforming estimators of $D(f,\theta)$.

\subsubsection{Directional Spectrum Estimators (Inversion Methods)}
Given $\mathbf{C}(f)$ and a forward model linking $D(f,\theta)$ to measurements, several estimators are common.

\paragraph{(i) Truncated Fourier/WIM reconstruction.}
Assume a Fourier series for $D$,
\begin{equation}
D(f,\theta) \approx \frac{1}{2\pi}\Bigg[
1 + 2\sum_{n=1}^{N_h}\Big( a_n(f)\cos n\theta + b_n(f)\sin n\theta\Big)
\Bigg],
\qquad N_h \in \{1,2\}.
\end{equation}
Use measured $(a_1,b_1,a_2,b_2)$ to reconstruct $D$ (Weighted Integral Method), with post-processing to enforce $D\ge0$, optional tapering or von~Mises fit.

\paragraph{(ii) Maximum Entropy (MEM).}
Choose $D$ to maximize Shannon entropy subject to matching measured harmonics (constraints):
\begin{align}
\max_{D\ge0}\quad & \mathcal{H}[D] = -\int_{0}^{2\pi} D\ln D\, d\theta,
\\
\text{s.t.}\quad & \int D\,d\theta=1,\quad 
\int D \cos n\theta\, d\theta = a_n,\quad 
\int D \sin n\theta\, d\theta = b_n,\; n=1,\ldots,N_h.
\end{align}
The solution has the exponential family form
\begin{equation}
D(\theta)\propto 
\exp\Big(\lambda_0 + \sum_{n=1}^{N_h}\lambda_n\cos n\theta + \mu_n\sin n\theta\Big),
\end{equation}
with Lagrange multipliers $(\lambda_n,\mu_n)$ found by solving the constraints.

\paragraph{(iii) Maximum Likelihood/Beamforming (MLM/EMLM).}
For an array with steering $\mathbf{a}(\theta;f)$ and CSD $\mathbf{C}(f)$, the classic Capon/MLM estimator is
\begin{equation}
\widehat{D}_{\text{MLM}}(f,\theta)
= \frac{1}{\mathbf{a}(\theta;f)^{\mathrm{H}}\,
\mathbf{C}(f)^{-1}\,\mathbf{a}(\theta;f)}\;\bigg/ \;
\int_{0}^{2\pi}\frac{d\varphi}{\mathbf{a}(\varphi;f)^{\mathrm{H}}\,
\mathbf{C}(f)^{-1}\,\mathbf{a}(\varphi;f)},
\end{equation}
optionally corrected for bias/noise in EMLM. This provides high directional resolution when aperture and SNR are adequate.

\paragraph{(iv) Nonnegative least squares (NNLS) on a directional grid.}
Discretize $\theta$ to $\{\theta_\ell\}$ and solve
\begin{equation}
\min_{\mathbf{d}\ge0}\;\big\|\mathbf{G}\mathbf{d}-\mathbf{y}\big\|_2^2 
\quad \text{s.t.}\quad \mathbf{1}^\top\mathbf{d}=1,
\end{equation}
where $\mathbf{y}$ stacks selected entries of $\mathbf{C}(f)$ (or $(a_n,b_n)$) and $\mathbf{G}$ contains the corresponding forward kernels at $\theta_\ell$.

\subsubsection{Remote Sensing (Brief)}
\emph{HF radar} exploits Bragg scattering to infer dominant wave directions and spectra near $f\approx f_B$ and harmonics; \emph{X-band marine radar} and \emph{stereo video} retrieve $S(\mathbf{k},\omega)$ via image sequences and a dispersion filter, then map to $S(f,\theta)$ by integrating along dispersion shells. \emph{Satellite SAR} estimates long-wave swell directions through modulation transfer functions and nonlinear mapping; temporal sampling limits wind-sea retrievals.

\subsubsection{Practical Workflow and QC}
\begin{enumerate}
\item \textbf{Preprocessing.} Remove trends/rotations; calibrate tilt-to-slope; correct mooring response if needed.
\item \textbf{Spectral estimation.} Choose segment length to resolve peak bandwidth; Hanning window; $50$--$75\%$ overlap; Welch averaging (report $\nu$).
\item \textbf{Depth and current effects.} Solve \eqref{eq:dispersion} for $k(f)$ (Newton iteration); apply pressure/velocity transfer functions; account for Doppler shift if strong currents ($\omega\to\omega-\mathbf{k}\cdot\mathbf{U}$).
\item \textbf{Directional inversion.} Prefer MEM/MLM when multiple crossing systems or narrow spreads; WIM/2nd-order Fourier adequate for broad wind sea.
\item \textbf{Uncertainty.} Propagate sampling error using $\nu$; for arrays, use Cramér--Rao bounds or bootstrap across segments; check nonnegativity and energy closure $\int D\,d\theta=1$.
\item \textbf{Validation.} Compare integral parameters (mean/peak direction, spread) and partitions with model/nearby sensors; investigate bimodality and wrap-around at $\theta=0/2\pi$.
\end{enumerate}

\paragraph{Outputs and Integral Measures.}
From $\widehat{S}(f,\theta)$ compute directional moments and spreads:
\begin{align}
\bar{\theta}(f) &= \arg\!\Big(\int e^{\mathrm{i}\theta} D(f,\theta)\, d\theta\Big), 
&
\sigma_\theta^2(f) &= 2\Big(1-\big|\int e^{\mathrm{i}\theta} D(f,\theta)\, d\theta\big|\Big),
\\
m_n &= \int f^n \bigg(\int S(f,\theta)\,d\theta\bigg)\, df,
&
H_s &= 4\sqrt{m_0},\quad T_z=\sqrt{m_0/m_2},\quad T_{-10}=m_{-1}/m_0.
\end{align}
Directional partitions (wind sea vs.\ swells) can then be obtained by algorithms in Section~\ref{sec:wave-partitioning}.

\paragraph{Common Pitfalls.}
(1) Underestimation at low $f$ from pressure attenuation without proper transfer correction; (2) directional bias if sensor axes misaligned or slopes miscalibrated; (3) positivity violations from truncated Fourier reconstructions; (4) array aliasing when aperture is too small relative to $k^{-1}$; (5) violating stationarity/linearity assumptions within analysis windows.

\section{Conclusion}
The journey from the early statistical observations of wave heights to the modern, spectral-based characterization of the sea surface represents a profound achievement in geophysical fluid dynamics. The foundational work of Longuet-Higgins in establishing the statistical properties of the Gaussian sea and its envelope provided the critical link between time-domain and frequency-domain analyses. The development of parametric models like Pierson-Moskowitz and JONSWAP created powerful, practical tools for engineers and scientists to describe the sea state with just a few parameters.

These theoretical models are not mere abstractions; they are embedded in the very hardware and software of modern wave measurement systems like data buoys. The process of converting raw accelerometer data into a directional wave spectrum and its derived bulk parameters is a direct application of this decades-old theory. While the linear Gaussian model has its limitations, leading to ongoing research into nonlinear effects and non-Rayleighian statistics, it remains the indispensable core of ocean wave modeling. It provides a consistent, robust, and profoundly useful framework for understanding and predicting the behavior of the ocean surface, enabling safety, economic activity, and scientific discovery across the world's oceans.

% Standalone Bibliography
\begin{thebibliography}{99}

\bibitem{longuet1952heights}
Longuet-Higgins, M. S. (1952).
On the statistical distribution of the heights of sea waves.
\textit{Journal of Marine Research}, \textbf{11}(3), 245–266.

\bibitem{longuet1963}
Longuet-Higgins, M. S. (1963).
The effect of non-linearities on statistical distributions in the theory of sea waves.
\textit{Journal of Fluid Mechanics}, \textbf{17}(3), 459–480.

\bibitem{pierson1964proposed}
Pierson, W. J., and Moskowitz, L. (1964).
A proposed spectral form for fully developed wind seas based on the similarity theory of S. A. Kitaigorodskii.
\textit{Journal of Geophysical Research}, \textbf{69}(24), 5181–5190.

\bibitem{hasselmann1973report}
Hasselmann, K., Barnett, T. P., Bouws, E., Carlson, H., Cartwright, D. E., Enke, K., ... and Walden, H. (1973).
Measurements of wind-wave growth and swell decay during the Joint North Sea Wave Project (JONSWAP).
\textit{Deutsches Hydrographisches Institut}, Reihe A(8â€“-12), 95.

\bibitem{hasselmann1962}
Hasselmann, K. (1962).
On the non-linear energy transfer in a gravity-wave spectrum. Part 1. General theory.
\textit{Journal of Fluid Mechanics}, \textbf{12}(4), 481–500.

\bibitem{tucker1991}
Tucker, M. J., and Pitt, E. G. (2001).
\textit{Waves in ocean engineering}.
Elsevier Science.

\bibitem{holthuijsen2007}
Holthuijsen, L. H. (2007).
\textit{Waves in oceanic and coastal waters}.
Cambridge University Press.

\bibitem{ndbcfaq}
National Data Buoy Center. (2023).
How are significant wave height, dominant period, and average period defined?
Retrieved from \url{https://www.ndbc.noaa.gov/wave.shtml}

\bibitem{earle1996}
Earle, M. D. (1996).
Nondirectional and directional wave data analysis procedures.
\textit{NDBC Technical Document}, 96-01.

\end{thebibliography}

\end{document}
