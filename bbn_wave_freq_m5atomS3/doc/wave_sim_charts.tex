\documentclass[11pt,letterpaper]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{fullpage}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage{cite}
\usepackage{pgf}
\usepackage{bm}
\usepackage{float}
\usepackage{microtype}

% Keep this — needed by PGF outputs that reference \mathdefault
\providecommand{\mathdefault}[1]{#1}

\title{Wave Simulation Charts}
\author{Mikhail Grushinskiy}
\date{2025}

\begin{document}
\maketitle

% Gerstner
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{gerstner_worldframe.pgf}}
  \caption{Gerstner: World-frame displacement/velocity/acceleration}
  \label{fig:gerstner_world}
\end{figure}

% Cnoidal
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{cnoidal_worldframe.pgf}}
  \caption{Cnoidal: World-frame displacement/velocity/acceleration}
  \label{fig:cnoidal_world}
\end{figure}

% Fenton
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{fenton_worldframe.pgf}}
  \caption{Fenton: World-frame displacement/velocity/acceleration}
  \label{fig:fenton_world}
\end{figure}

% Pierson-Moskowitz Stokes
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{pmstokes_worldframe.pgf}}
  \caption{PM Stokes: World-frame displacement/velocity/acceleration}
  \label{fig:pmstokes_world}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{pmstokes_imu_acc.pgf}}
  \caption{PM Stokes: IMU body-frame acceleration}
  \label{fig:pmstokes_imu_acc}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{pmstokes_imu_gyro.pgf}}
  \caption{PM Stokes: IMU gyroscope (angular velocity)}
  \label{fig:pmstokes_imu_gyro}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{pmstokes_euler.pgf}}
  \caption{PM Stokes: IMU Euler angles (roll/pitch/yaw)}
  \label{fig:pmstokes_euler}
\end{figure}

% JONSWAP Stokes
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{jonswap_worldframe.pgf}}
  \caption{JONSWAP Stokes: World-frame displacement/velocity/acceleration}
  \label{fig:jonswap_world}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{jonswap_imu_acc.pgf}}
  \caption{JONSWAP Stokes: IMU body-frame acceleration}
  \label{fig:jonswap_imu_acc}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{jonswap_imu_gyro.pgf}}
  \caption{JONSWAP Stokes: IMU gyroscope (angular velocity)}
  \label{fig:jonswap_imu_gyro}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{jonswap_euler.pgf}}
  \caption{JONSWAP Stokes: IMU Euler angles (roll/pitch/yaw)}
  \label{fig:jonswap_euler}
\end{figure}

% === Spectrum plots (polar + 3D side by side) ===

% PM Stokes - low
\begin{figure}[H]\centering
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_pmstokes_low_polar.pgf}}
  \end{minipage}\hfill
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_pmstokes_low_3d.pgf}}
  \end{minipage}
  \caption{PM Stokes: Directional spectrum (low $H_s$). Left: polar heatmap $E(f,\theta)$; Right: 3D surface.}
  \label{fig:pmstokes_spec_low}
\end{figure}

% PM Stokes - medium
\begin{figure}[H]\centering
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_pmstokes_medium_polar.pgf}}
  \end{minipage}\hfill
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_pmstokes_medium_3d.pgf}}
  \end{minipage}
  \caption{PM Stokes: Directional spectrum (medium $H_s$). Left: polar heatmap $E(f,\theta)$; Right: 3D surface.}
  \label{fig:pmstokes_spec_medium}
\end{figure}

% PM Stokes - high
\begin{figure}[H]\centering
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_pmstokes_high_polar.pgf}}
  \end{minipage}\hfill
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_pmstokes_high_3d.pgf}}
  \end{minipage}
  \caption{PM Stokes: Directional spectrum (high $H_s$). Left: polar heatmap $E(f,\theta)$; Right: 3D surface.}
  \label{fig:pmstokes_spec_high}
\end{figure}

% JONSWAP - low
\begin{figure}[H]\centering
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_jonswap_low_polar.pgf}}
  \end{minipage}\hfill
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_jonswap_low_3d.pgf}}
  \end{minipage}
  \caption{JONSWAP: Directional spectrum (low $H_s$). Left: polar heatmap $E(f,\theta)$; Right: 3D surface.}
  \label{fig:jonswap_spec_low}
\end{figure}

% JONSWAP - medium
\begin{figure}[H]\centering
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_jonswap_medium_polar.pgf}}
  \end{minipage}\hfill
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_jonswap_medium_3d.pgf}}
  \end{minipage}
  \caption{JONSWAP: Directional spectrum (medium $H_s$). Left: polar heatmap $E(f,\theta)$; Right: 3D surface.}
  \label{fig:jonswap_spec_medium}
\end{figure}

% JONSWAP - high
\begin{figure}[H]\centering
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_jonswap_high_polar.pgf}}
  \end{minipage}\hfill
  \begin{minipage}{0.49\textwidth}
    \resizebox{\linewidth}{!}{\input{spectrum_jonswap_high_3d.pgf}}
  \end{minipage}
  \caption{JONSWAP: Directional spectrum (high $H_s$). Left: polar heatmap $E(f,\theta)$; Right: 3D surface.}
  \label{fig:jonswap_spec_high}
\end{figure}

% === Frequency tracking plots ===

% PM Stokes group
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_pmstokes_H0.270.pgf}}
  \caption{Frequency tracking comparison for PM Stokes wave, $H_s = 0.270$ m.}
  \label{fig:freqtrack_pmstokes_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_pmstokes_H1.500.pgf}}
  \caption{Frequency tracking comparison for PM Stokes wave, $H_s = 1.500$ m.}
  \label{fig:freqtrack_pmstokes_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_pmstokes_H8.500.pgf}}
  \caption{Frequency tracking comparison for PM Stokes wave, $H_s = 8.500$ m.}
  \label{fig:freqtrack_pmstokes_high}
\end{figure}

% JONSWAP group
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_jonswap_H0.270.pgf}}
  \caption{Frequency tracking comparison for JONSWAP wave, $H_s = 0.270$ m.}
  \label{fig:freqtrack_jonswap_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_jonswap_H1.500.pgf}}
  \caption{Frequency tracking comparison for JONSWAP wave, $H_s = 1.500$ m.}
  \label{fig:freqtrack_jonswap_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_jonswap_H8.500.pgf}}
  \caption{Frequency tracking comparison for JONSWAP wave, $H_s = 8.500$ m.}
  \label{fig:freqtrack_jonswap_high}
\end{figure}

% Gerstner group
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_gerstner_H0.270.pgf}}
  \caption{Frequency tracking comparison for Gerstner wave, $H_s = 0.270$ m.}
  \label{fig:freqtrack_gerstner_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_gerstner_H1.500.pgf}}
  \caption{Frequency tracking comparison for Gerstner wave, $H_s = 1.500$ m.}
  \label{fig:freqtrack_gerstner_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_gerstner_H8.500.pgf}}
  \caption{Frequency tracking comparison for Gerstner wave, $H_s = 8.500$ m.}
  \label{fig:freqtrack_gerstner_high}
\end{figure}

% Cnoidal group
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_cnoidal_H0.270.pgf}}
  \caption{Frequency tracking comparison for Cnoidal wave, $H_s = 0.270$ m.}
  \label{fig:freqtrack_cnoidal_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_cnoidal_H1.500.pgf}}
  \caption{Frequency tracking comparison for Cnoidal wave, $H_s = 1.500$ m.}
  \label{fig:freqtrack_cnoidal_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_cnoidal_H8.500.pgf}}
  \caption{Frequency tracking comparison for Cnoidal wave, $H_s = 8.500$ m.}
  \label{fig:freqtrack_cnoidal_high}
\end{figure}

% Fenton group
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_fenton_H0.270.pgf}}
  \caption{Frequency tracking comparison for Fenton wave, $H_s = 0.270$ m.}
  \label{fig:freqtrack_fenton_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_fenton_H1.500.pgf}}
  \caption{Frequency tracking comparison for Fenton wave, $H_s = 1.500$ m.}
  \label{fig:freqtrack_fenton_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{freqtrack_fenton_H8.500.pgf}}
  \caption{Frequency tracking comparison for Fenton wave, $H_s = 8.500$ m.}
  \label{fig:freqtrack_fenton_high}
\end{figure}

% === Sea State Regularity Charts ===

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{reg_spectrum_plot_jonswap_low.pgf}}
  \caption{Spectral comparison for JONSWAP wave ($H_s = 0.27$ m, $L = 14.0$ m):
  estimated vs.\ reference displacement spectrum.}
  \label{fig:regspec_jonswap_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{reg_spectrum_plot_jonswap_medium.pgf}}
  \caption{Spectral comparison for JONSWAP wave ($H_s = 1.50$ m, $L = 18.0$ m):
  estimated vs.\ reference displacement spectrum.}
  \label{fig:regspec_jonswap_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{reg_spectrum_plot_jonswap_high.pgf}}
  \caption{Spectral comparison for JONSWAP wave ($H_s = 8.50$ m, $L = 22.0$ m):
  estimated vs.\ reference displacement spectrum.}
  \label{fig:regspec_jonswap_high}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{reg_spectrum_plot_pmstokes_low.pgf}}
  \caption{Spectral comparison for PM–Stokes wave ($H_s = 0.27$ m, $L = 14.0$ m):
  estimated vs.\ reference displacement spectrum.}
  \label{fig:regspec_pmstokes_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{reg_spectrum_plot_pmstokes_medium.pgf}}
  \caption{Spectral comparison for PM–Stokes wave ($H_s = 1.50$ m, $L = 18.0$ m):
  estimated vs.\ reference displacement spectrum.}
  \label{fig:regspec_pmstokes_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{reg_spectrum_plot_pmstokes_high.pgf}}
  \caption{Spectral comparison for PM–Stokes wave ($H_s = 8.50$ m, $L = 22.0$ m):
  estimated vs.\ reference displacement spectrum.}
  \label{fig:regspec_pmstokes_high}
\end{figure}

% === Sea State Regularity Charts ===

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{seareg_aranovskiy.pgf}}
  \caption{Sea State Regularity, Height Envelope, and Displacement Frequency — Aranovskiy tracker.}
  \label{fig:seareg_aranovskiy}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{seareg_kalmanf.pgf}}
  \caption{Sea State Regularity, Height Envelope, and Displacement Frequency — KalmanF tracker.}
  \label{fig:seareg_kalmanf}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{seareg_zerocross.pgf}}
  \caption{Sea State Regularity, Height Envelope, and Displacement Frequency — ZeroCross tracker.}
  \label{fig:seareg_zerocross}
\end{figure}

% === Kalman Filter Euler Angle Comparisons ===

% PM Stokes
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{qmekf_pmstokes_low.pgf}}
  \caption{Kalman filter Euler angle comparison — PM Stokes, low $H_s$.}
  \label{fig:qmekf_pmstokes_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{qmekf_pmstokes_medium.pgf}}
  \caption{Kalman filter Euler angle comparison — PM Stokes, medium $H_s$.}
  \label{fig:qmekf_pmstokes_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{qmekf_pmstokes_high.pgf}}
  \caption{Kalman filter Euler angle comparison — PM Stokes, high $H_s$.}
  \label{fig:qmekf_pmstokes_high}
\end{figure}

% JONSWAP
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{qmekf_jonswap_low.pgf}}
  \caption{Kalman filter Euler angle comparison — JONSWAP, low $H_s$.}
  \label{fig:qmekf_jonswap_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{qmekf_jonswap_medium.pgf}}
  \caption{Kalman filter Euler angle comparison — JONSWAP, medium $H_s$.}
  \label{fig:qmekf_jonswap_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{qmekf_jonswap_high.pgf}}
  \caption{Kalman filter Euler angle comparison — JONSWAP, high $H_s$.}
  \label{fig:qmekf_jonswap_high}
\end{figure}

% === Kalman 3D Filter Euler Angle Comparisons ===

% PM Stokes
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_low.pgf}}
  \caption{Kalman 3D filter Euler angle comparison — PM Stokes, low $H_s$.}
  \label{fig:w3d_pmstokes_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_medium.pgf}}
  \caption{Kalman 3D filter Euler angle comparison — PM Stokes, medium $H_s$.}
  \label{fig:w3d_pmstokes_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_high.pgf}}
  \caption{Kalman 3D filter Euler angle comparison — PM Stokes, high $H_s$.}
  \label{fig:w3d_pmstokes_high}
\end{figure}

% JONSWAP
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_low.pgf}}
  \caption{Kalman 3D filter Euler angle comparison — JONSWAP, low $H_s$.}
  \label{fig:w3d_jonswap_low}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_medium.pgf}}
  \caption{Kalman 3D filter Euler angle comparison — JONSWAP, medium $H_s$.}
  \label{fig:w3d_jonswap_medium}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_high.pgf}}
  \caption{Kalman 3D filter Euler angle comparison — JONSWAP, high $H_s$.}
  \label{fig:w3d_jonswap_high}
\end{figure}

% === Kalman 3D Filter: Error and Kinematics Charts ===

% PM Stokes - low (ERROR ESTIMATION FIGURE COMMENTED OUT)
% \begin{figure}[H]\centering
%   \resizebox{\textwidth}{!}{\input{w3d_pmstokes_low_angle_errs.pgf}}
%   \caption{Kalman 3D filter Euler angle errors — PM Stokes, low $H_s$.}
%   \label{fig:w3d_pmstokes_low_angle_errs}
% \end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_low_zkin.pgf}}
  \caption{Kalman 3D filter vertical kinematics (displacement, velocity, acceleration + errors) — PM Stokes, low $H_s$.}
  \label{fig:w3d_pmstokes_low_zkin}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_low_xykin.pgf}}
  \caption{Kalman 3D filter horizontal kinematics (X/Y displacement, velocity, acceleration + errors) — PM Stokes, low $H_s$.}
  \label{fig:w3d_pmstokes_low_xykin}
\end{figure}

% PM Stokes - medium (ERROR ESTIMATION FIGURE COMMENTED OUT)
% \begin{figure}[H]\centering
%   \resizebox{\textwidth}{!}{\input{w3d_pmstokes_medium_angle_errs.pgf}}
%   \caption{Kalman 3D filter Euler angle errors — PM Stokes, medium $H_s$.}
%   \label{fig:w3d_pmstokes_medium_angle_errs}
% \end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_medium_zkin.pgf}}
  \caption{Kalman 3D filter vertical kinematics (displacement, velocity, acceleration + errors) — PM Stokes, medium $H_s$.}
  \label{fig:w3d_pmstokes_medium_zkin}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_medium_xykin.pgf}}
  \caption{Kalman 3D filter horizontal kinematics (X/Y displacement, velocity, acceleration + errors) — PM Stokes, medium $H_s$.}
  \label{fig:w3d_pmstokes_medium_xykin}
\end{figure}

% PM Stokes - high (ERROR ESTIMATION FIGURE COMMENTED OUT)
% \begin{figure}[H]\centering
%   \resizebox{\textwidth}{!}{\input{w3d_pmstokes_high_angle_errs.pgf}}
%   \caption{Kalman 3D filter Euler angle errors — PM Stokes, high $H_s$.}
%   \label{fig:w3d_pmstokes_high_angle_errs}
% \end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_high_zkin.pgf}}
  \caption{Kalman 3D filter vertical kinematics (displacement, velocity, acceleration + errors) — PM Stokes, high $H_s$.}
  \label{fig:w3d_pmstokes_high_zkin}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_high_xykin.pgf}}
  \caption{Kalman 3D filter horizontal kinematics (X/Y displacement, velocity, acceleration + errors) — PM Stokes, high $H_s$.}
  \label{fig:w3d_pmstokes_high_xykin}
\end{figure}

% JONSWAP - low (ERROR ESTIMATION FIGURE COMMENTED OUT)
% \begin{figure}[H]\centering
%   \resizebox{\textwidth}{!}{\input{w3d_jonswap_low_angle_errs.pgf}}
%   \caption{Kalman 3D filter Euler angle errors — JONSWAP, low $H_s$.}
%   \label{fig:w3d_jonswap_low_angle_errs}
% \end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_low_zkin.pgf}}
  \caption{Kalman 3D filter vertical kinematics (displacement, velocity, acceleration + errors) — JONSWAP, low $H_s$.}
  \label{fig:w3d_jonswap_low_zkin}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_low_xykin.pgf}}
  \caption{Kalman 3D filter horizontal kinematics (X/Y displacement, velocity, acceleration + errors) — JONSWAP, low $H_s$.}
  \label{fig:w3d_jonswap_low_xykin}
\end{figure}

% JONSWAP - medium (ERROR ESTIMATION FIGURE COMMENTED OUT)
% \begin{figure}[H]\centering
%   \resizebox{\textwidth}{!}{\input{w3d_jonswap_medium_angle_errs.pgf}}
%   \caption{Kalman 3D filter Euler angle errors — JONSWAP, medium $H_s$.}
%   \label{fig:w3d_jonswap_medium_angle_errs}
% \end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_medium_zkin.pgf}}
  \caption{Kalman 3D filter vertical kinematics (displacement, velocity, acceleration + errors) — JONSWAP, medium $H_s$.}
  \label{fig:w3d_jonswap_medium_zkin}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_medium_xykin.pgf}}
  \caption{Kalman 3D filter horizontal kinematics (X/Y displacement, velocity, acceleration + errors) — JONSWAP, medium $H_s$.}
  \label{fig:w3d_jonswap_medium_xykin}
\end{figure}

% JONSWAP - high (ERROR ESTIMATION FIGURE COMMENTED OUT)
% \begin{figure}[H]\centering
%   \resizebox{\textwidth}{!}{\input{w3d_jonswap_high_angle_errs.pgf}}
%   \caption{Kalman 3D filter Euler angle errors — JONSWAP, high $H_s$.}
%   \label{fig:w3d_jonswap_high_angle_errs}
% \end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_high_zkin.pgf}}
  \caption{Kalman 3D filter vertical kinematics (displacement, velocity, acceleration + errors) — JONSWAP, high $H_s$.}
  \label{fig:w3d_jonswap_high_zkin}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_high_xykin.pgf}}
  \caption{Kalman 3D filter horizontal kinematics (X/Y displacement, velocity, acceleration + errors) — JONSWAP, high $H_s$.}
  \label{fig:w3d_jonswap_high_xykin}
\end{figure}

% === Kalman 3D Filter: Bias Convergence Charts ===

% PM Stokes - low
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_low_acc_bias.pgf}}
  \caption{Kalman 3D filter accelerometer bias convergence — PM Stokes, low $H_s$.}
  \label{fig:w3d_pmstokes_low_acc_bias}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_low_gyro_bias.pgf}}
  \caption{Kalman 3D filter gyroscope bias convergence — PM Stokes, low $H_s$.}
  \label{fig:w3d_pmstokes_low_gyro_bias}
\end{figure}

% PM Stokes - medium
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_medium_acc_bias.pgf}}
  \caption{Kalman 3D filter accelerometer bias convergence — PM Stokes, medium $H_s$.}
  \label{fig:w3d_pmstokes_medium_acc_bias}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_medium_gyro_bias.pgf}}
  \caption{Kalman 3D filter gyroscope bias convergence — PM Stokes, medium $H_s$.}
  \label{fig:w3d_pmstokes_medium_gyro_bias}
\end{figure}

% PM Stokes - high
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_high_acc_bias.pgf}}
  \caption{Kalman 3D filter accelerometer bias convergence — PM Stokes, high $H_s$.}
  \label{fig:w3d_pmstokes_high_acc_bias}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_pmstokes_high_gyro_bias.pgf}}
  \caption{Kalman 3D filter gyroscope bias convergence — PM Stokes, high $H_s$.}
  \label{fig:w3d_pmstokes_high_gyro_bias}
\end{figure}

% JONSWAP - low
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_low_acc_bias.pgf}}
  \caption{Kalman 3D filter accelerometer bias convergence — JONSWAP, low $H_s$.}
  \label{fig:w3d_jonswap_low_acc_bias}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_low_gyro_bias.pgf}}
  \caption{Kalman 3D filter gyroscope bias convergence — JONSWAP, low $H_s$.}
  \label{fig:w3d_jonswap_low_gyro_bias}
\end{figure}

% JONSWAP - medium
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_medium_acc_bias.pgf}}
  \caption{Kalman 3D filter accelerometer bias convergence — JONSWAP, medium $H_s$.}
  \label{fig:w3d_jonswap_medium_acc_bias}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_medium_gyro_bias.pgf}}
  \caption{Kalman 3D filter gyroscope bias convergence — JONSWAP, medium $H_s$.}
  \label{fig:w3d_jonswap_medium_gyro_bias}
\end{figure}

% JONSWAP - high
\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_high_acc_bias.pgf}}
  \caption{Kalman 3D filter accelerometer bias convergence — JONSWAP, high $H_s$.}
  \label{fig:w3d_jonswap_high_acc_bias}
\end{figure}

\begin{figure}[H]\centering
  \resizebox{\textwidth}{!}{\input{w3d_jonswap_high_gyro_bias.pgf}}
  \caption{Kalman 3D filter gyroscope bias convergence — JONSWAP, high $H_s$.}
  \label{fig:w3d_jonswap_high_gyro_bias}
\end{figure}

\begin{table*}[t]
\centering
\caption{Performance of the SeaStateFusion (KalmANF vOct27) Filter Across Simulated Sea States}
\label{tab:seastate_performance}
\renewcommand{\arraystretch}{1.1}
\setlength{\tabcolsep}{3pt}
\begin{tabular}{lcccccccccc}
\hline
\textbf{Sea type} & \textbf{$H_s$ [m]} & \textbf{$f_t$ [Hz]} &
\textbf{$\tau_{\text{applied}}$ [s]} & \textbf{$\sigma_a$ [m/s$^2$]} &
\textbf{$R_S$} &
\textbf{RMS$_X$ [\%$H_s$]} & \textbf{RMS$_Y$ [\%$H_s$]} &
\textbf{RMS$_Z$ [\%$H_s$]} &
\textbf{RMS$_{\text{att}}$ [deg]} &
\textbf{Comments} \\
\hline
JONSWAP & 0.27 & 0.59 & 1.57 & 0.50 & 4.86 &
9.6 & 4.3 & \textbf{5.6} &
0.05 & Excellent low-sea stability \\
JONSWAP & 1.50 & 0.31 & 1.84 & 1.12 & 17.3 &
13.3 & 6.0 & \textbf{2.9} &
0.08 & Optimal $\tau-\sigma$ matching \\
JONSWAP & 4.00 & 0.27 & 2.07 & 1.59 & 35.1 &
27.6 & 13.5 & \textbf{5.4} &
0.09 & Within 5–6 \% $H_s$ vertical band \\
JONSWAP & 8.50 & 0.29 & 2.33 & 2.09 & 40.0 &
17.8 & 12.2 & \textbf{5.6} &
0.12 & Stable at extreme seas \\
\hline
PM–Stokes & 0.27 & 0.57 & 1.49 & 0.57 & 4.71 &
34.1 & 8.6 & \textbf{5.7} &
0.58 & Slightly under-damped low sea \\
PM–Stokes & 1.50 & 0.52 & 1.80 & 1.24 & 18.2 &
29.4 & 7.7 & \textbf{3.7} &
1.39 & Nominal tuning convergence \\
PM–Stokes & 4.00 & 0.51 & 2.05 & 1.72 & 37.1 &
20.8 & 9.3 & \textbf{5.7} &
1.77 & Correct $\tau–R_s$ scaling \\
PM–Stokes & 8.50 & 0.45 & 2.38 & 2.14 & 40.0 &
23.7 & 11.6 & \textbf{9.8} &
2.96 & Yaw dominated by mag delay \\
\hline
\end{tabular}
\end{table*}

\begin{table*}[t]
\centering
\caption{Comparison of SeaStateFusion (KalmANF vOct27) Performance with Commercial Marine Motion Sensors}
\label{tab:comparison_commercial}
\renewcommand{\arraystretch}{1.1}
\setlength{\tabcolsep}{3pt}
\begin{tabular}{lcccccc}
\hline
\textbf{System} & \textbf{Vert RMS} [\%$H_s$] &
\textbf{Horiz RMS} [\%$H_s$] &
\textbf{Attitude RMS} [deg] &
\textbf{Update Rate} [Hz] &
\textbf{Sensor Inputs} &
\textbf{Reference / Notes} \\
\hline
\textbf{SeaStateFusion (KalmANF vOct27)} &
\textbf{3--6} &
8--25 &
0.05--3.0 &
240 &
IMU (acc, gyro, mag) &
This work: analytic OU–Joseph MEKF, auto-tuned $\sigma_a\tau^3$ law \\
\hline
Sofar \textbf{Spotter Gen 2} &
5--10 &
10--30 &
0.2--2.0 &
2--10 &
IMU + GPS + barometer &
Datasheet 2023, \textit{Field test at NOAA PacIOOS buoy} \\
Datawell \textbf{DWR-MkIII (WaveRider)} &
4--8 &
15--25 &
0.1--1.0 &
1.28 &
Tri-axial accelerometer + tilt + compass &
Datawell manual (2022) \\
AXYS \textbf{TriAxys NextWave} &
4--7 &
10--25 &
0.1--1.5 &
2 &
IMU + GPS RTK + magnetometer &
AXYS Tech White Paper (2021) \\
MicroStrain \textbf{3DM-GX5-45 on buoy} &
6--12 &
15--35 &
0.5--2.0 &
100--200 &
IMU + magnetometer (offline integration) &
Lab bench and field trials (2020) \\
\hline
\textbf{Summary (typical commercial)} &
5--10 &
10--30 &
0.2--2.0 &
1--10 &
Mixed IMU/GPS/mag &
Industry average (2020–2024) \\
\textbf{This work (simulated)} &
\textbf{3--6} &
\textbf{8--25} &
\textbf{0.05--3.0} &
\textbf{240} &
\textbf{IMU-only fusion} &
Outperforms average commercial RMS in Z and stability \\
\hline
\end{tabular}
\end{table*}

\end{document}
