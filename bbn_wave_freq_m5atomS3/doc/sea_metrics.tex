\documentclass[11pt]{article}
\usepackage{amsmath, amssymb, bm, geometry, cite, float, longtable}
\geometry{margin=1in}

\title{SeaMetrics: Online Estimation of Ocean Wave Spectral Metrics}
\author{Mikhail Grushinskiy}
\date{2025}

\begin{document}
\maketitle

\section{Introduction}

\texttt{SeaMetrics} is an online estimator of ocean wave spectral metrics
derived from vertical acceleration $a_z(t)$ and an externally tracked instantaneous frequency $\omega_{\text{inst}}(t)$.  
The tool demodulates acceleration, converts it to displacement envelope power, and tracks
running averages of spectral moments.  
From these, a broad set of oceanographic quantities can be computed in real time, ranging from
basic spectral moments to derived parameters such as significant wave height, mean period,
bandwidth, groupiness, nonlinearity, breaking probability, and even human comfort indices.

\section{Spectral Moments}

The raw spectral moments are
\begin{align}
M_n = \left\langle P_{\eta}(t)\,\omega(t)^n \right\rangle, \quad n = -1,0,1,2,3,4,
\end{align}
where $P_{\eta}(t)$ is the instantaneous displacement envelope power.  

\begin{itemize}
  \item $M_0$: total variance of surface displacement (``wave energy'').
  \item $M_1$: energy-weighted mean frequency numerator.
  \item $M_2$: energy-weighted mean square frequency; linked to wave slopes and upcrossing rate.
  \item $M_3$, $M_4$: higher moments, enabling skewness, kurtosis, and peakedness diagnostics.
  \item $M_{-1}$: negative-order moment, used in energy flux and mean wave energy period definitions.
\end{itemize}

\section{Central Moments and Shape Metrics}

From $M_n$ one can form central moments:
\begin{align}
\mu_2 &= \frac{M_2}{M_0} - \left(\frac{M_1}{M_0}\right)^2, \\
\mu_3 &= \frac{M_3}{M_0} - 3\mu\frac{M_2}{M_0} + 2\mu^3, \\
\mu_4 &= \frac{M_4}{M_0} - 4\mu\frac{M_3}{M_0} + 6\mu^2 \frac{M_2}{M_0} - 3\mu^4,
\end{align}
with $\mu = M_1/M_0$.  
They describe spectral \emph{shape}:
\begin{itemize}
  \item $\mu_2$: spectral variance (spread around mean frequency).
  \item $\mu_3$: asymmetry (positive skew $\to$ high-frequency tail dominance).
  \item $\mu_4$: flatness (kurtosis, peakedness vs. broadness).
\end{itemize}

From these, common diagnostics include:
\[
\text{Skewness} = \frac{\mu_3}{\mu_2^{3/2}}, \quad
\text{Kurtosis} = \frac{\mu_4}{\mu_2^2}, \quad
\text{Excess Kurtosis} = \frac{\mu_4}{\mu_2^2} - 3.
\]

Other shape-related parameters include:
\begin{itemize}
  \item Ochi peakedness: $Q = \tfrac{M_0 M_4}{M_2^2}$.
  \item Benassai parameter: same definition, used in engineering design.
  \item Goda peakedness: $Q_G = 2(Q-1)$.
\end{itemize}

\section{Frequency Metrics}

\begin{itemize}
  \item Mean frequency: $\bar{\omega} = M_1/M_0$, $\bar{f} = \bar{\omega}/(2\pi)$.
  \item Relative bandwidth (RBW): $\sqrt{\mu_2}/\bar{\omega}$, dimensionless measure of spectral width.
  \item Phase-increment RBW: variance of $\Delta\phi/\Delta t$ normalized by $\bar{\omega}$; independent check based on phase jitter.
\end{itemize}

\section{Regularity Metrics}

\begin{itemize}
  \item Spectral regularity: $R_{\text{spec}} = \exp(-\beta\cdot \text{RBW})$, decays with spectral width.
  \item Phase regularity: $R_{\text{phase}} = \|\langle z/|z|\rangle\|$, sensitive to phase coherence.
  \item Narrowness: $\nu = \sqrt{M_0 M_2/M_1^2 - 1}$, classical measure of spectral compactness.
\end{itemize}

\section{Period Summaries}

Periods summarize average cycle times of waves:
\begin{align}
T_z &= \sqrt{2\pi^2 \tfrac{M_0}{M_2}} \quad \text{(mean zero-crossing period)}, \\
T_1 &= \tfrac{2\pi M_0}{M_1} \quad \text{(mean period)}, \\
T_{m02} &= 2\pi\sqrt{M_0/M_2} \quad \text{(mean period from variance)}, \\
T_e &= \tfrac{2\pi M_{-1}}{M_0} \quad \text{(energy period)}, \\
T_{m0,-1} &= M_0/M_{-1}, \quad
T_{m1,-1} = M_1/M_{-1}.
\end{align}

The upcrossing rate
\[
\nu_{\uparrow} = \frac{1}{2\pi}\sqrt{\frac{M_2}{M_0}}
\]
gives the expected number of wave cycles per second, enabling wave counting with confidence intervals.

\section{Heights and Steepness}

\begin{align}
\sigma &= \sqrt{M_0} \quad \text{(RMS displacement)}, \\
H_s &= 2\sqrt{2}\,\sigma \quad \text{(significant wave height, Rayleigh)}, \\
\text{Steepness} &= \frac{H_s}{L_0}, \quad L_0 = \frac{g T_z^2}{2\pi}.
\end{align}

\section{Probabilities and Extremes}

\begin{itemize}
  \item Crest exceedance probability (linear Rayleigh):
  \[
  P(H_c > h) = \exp\!\left(-\frac{h^2}{2\sigma^2}\right).
  \]
  \item Nonlinear Tayfun exceedance:
  \[
  P(H_c > h) \approx \exp\!\left(-\frac{h^2}{2\sigma^2}\right)\exp\!\left(\Lambda \frac{h^3}{\sigma^3}\right),
  \]
  with $\Lambda$ proportional to steepness.
  \item Quantile crests: $H_{1/10}, H_{1/100}$.
  \item Expected maximum crest height in duration $T$:  
  $E[H_{\max}] \approx \sigma(\sqrt{2\ln N} + \gamma/\sqrt{2\ln N})$, with $N$ wave count, $\gamma$ Euler constant.
\end{itemize}

\section{Bandwidth Metrics}

Multiple definitions of spectral bandwidth are available:
\begin{align}
\varepsilon_{\text{CLH}} &= \sqrt{1 - \tfrac{M_1^2}{M_0 M_2}} \quad \text{(Cartwright–Longuet-Higgins)}, \\
\varepsilon_{\text{Goda}} &= \sqrt{\tfrac{M_0 M_2}{M_1^2} - 1}, \\
\varepsilon_{\text{Kuik}} &= \frac{\sqrt{M_0 M_2 - M_1^2}}{M_1}, \\
\varepsilon_{\text{LH}} &= \sqrt{\tfrac{M_0 M_2}{M_1^2} - 1} \quad \text{(Longuet–Higgins width)}.
\end{align}

\section{Groupiness and Instability}

\begin{itemize}
  \item Groupiness factor: $G = T_g/T_z$, ratio of group period to zero-crossing period.
  \item Benjamin–Feir Index (BFI): instability measure for modulational growth,
  \[
  \text{BFI} = \frac{\sqrt{2}\,H_s/L_0}{\Delta f/f_p},
  \]
  where $f_p$ is peak frequency and $\Delta f$ spectral bandwidth.
\end{itemize}

\section{Energy and Power}

\begin{align}
T_{e,\text{flux}} &= \frac{M_{-1}}{M_0} \quad \text{(energy flux period)}, \\
P &= \frac{\rho g^2}{64\pi} H_s^2 T_e \quad \text{(deep-water wave power)}, \\
E &= \rho g M_0 \quad \text{(wave energy density)}.
\end{align}

\section{Nonlinear and Development Metrics}

\begin{itemize}
  \item Ursell number: $Ur = \tfrac{H L^2}{h^3}$, ratio of nonlinearity to dispersion in finite depth $h$.
  \item Nonlinearity parameter: $n = \tfrac{1}{2}H_s k$, dimensionless steepness at spectral peak.
  \item Wave age: $c_p/U_{10}$, ratio of phase speed to wind speed, indicates maturity of sea state.
\end{itemize}

\section{Breaking Indicators}

\begin{itemize}
  \item Probability of breaking: depth-limited proxy $\exp(-0.5(0.78h/H_s)^2)$ or steepness proxy $10(H_s/L_0)$.
  \item Breaking height: $H_b \approx 0.78 h$, depth-limited maximum crest.
\end{itemize}

\section{Comfort and Motion Sickness}

\begin{itemize}
  \item Motion Sickness Dose Value (MSDV):  
  $\text{MSDV} = \sqrt{M_2}\sqrt{T}$ over exposure duration $T$.
  \item Seasickness incidence (ISO-based): logistic function of MSDV, frequency, and susceptibility.
  \item Comfort level rating: heuristic mapping of MSDV to 0–100 scale.
  \item Vertical motion intensity: $\sqrt{M_2}$.
  \item Time to onset: empirical $\propto 1/(\text{accel} \cdot f^{0.7})$.
\end{itemize}

\section{Extreme Value Analysis}

Beyond Rayleigh and Tayfun probabilities, the system supports:
\begin{itemize}
  \item \textbf{Weibull return height:} Fit of a 2-parameter Weibull distribution to block maxima, enabling return-level estimation for a given return period $T_{\text{return}}$.
  \item \textbf{Peak-over-threshold (POT) mean excess:} Expected average crest height above a specified threshold, useful for storm peak analysis.
\end{itemize}

\section{Shallow-Water Extensions}

When depth $h$ is finite, dispersion becomes
\[
\omega^2 = gk \tanh(kh),
\]
solved iteratively for $k$. Additional metrics include:
\begin{itemize}
  \item \textbf{Shoaling coefficient $K_s$:} Accounts for change in group velocity with depth.
  \item \textbf{Refraction coefficient:} Based on Snell’s law using $c=\omega/k$.
  \item \textbf{Battjes–Janssen breaking probability:} Wave breaking probability parameterized by depth and breaker index $\gamma$.
\end{itemize}

\section{Data Quality and Diagnostics}

\begin{itemize}
  \item \textbf{Temporal stability:} Running variance of $H_s$ compared to a reference window, indicating stationarity of sea state.
  \item \textbf{Signal-to-noise ratio (band-limited):} Ratio of in-band variance to total variance, for arbitrary frequency bands.
  \item \textbf{Data gap fraction:} Fraction of missing samples detected from invalid inputs.
\end{itemize}

\section{Integration with Environmental Inputs}

\begin{itemize}
  \item \textbf{Wave age classification:} Categorical classification (young / mature / old swell) based on $c_p/U_{10}$.
  \item \textbf{Sea–swell partitioning:} Fraction of total energy attributable to swell, estimated from wave age.
  \item \textbf{Radiation stresses:} Scalar proxies $S_{xx}, S_{yy}$ proportional to $H_s^2$, relevant for coastal setup and sediment transport.
\end{itemize}

\section{Application-Specific Metrics}

\begin{itemize}
  \item \textbf{Bottom orbital velocity:} Near-bed orbital speed at depth $h$, estimated from linear wave theory.
  \item \textbf{WEC capture width ratio:} Ratio of extracted wave energy converter power to incident wave power per crest length.
\end{itemize}

\section{Bias Correction}

\subsection{Motivation}

When frequency estimates $\omega$ are noisy, any metrics involving inverse powers $1/\omega^n$ are biased high due to Jensen’s inequality.  
For example,
\[
E\!\left[\frac{1}{\omega^2}\right] \neq \frac{1}{E[\omega]^2}.
\]

\subsection{First-Order Correction}

Expanding about mean $\bar{\omega}$ with variance $\sigma_\omega^2$:
\[
E\!\left[\frac{1}{\omega^n}\right] \approx \frac{1}{\bar{\omega}^n}
\left(1 + c_n \frac{\sigma_\omega^2}{\bar{\omega}^2}\right),
\]
with coefficients
\[
c_1 = 1,\quad c_2 = 3,\quad c_3 = 6,\quad c_4 = 10.
\]

Thus bias-corrected moments are:
\begin{align}
M_0^c &= \frac{M_0}{1 + 10 \sigma_\omega^2 / \bar{\omega}^2}, \\
M_1^c &= \frac{M_1}{1 + 6 \sigma_\omega^2 / \bar{\omega}^2}, \\
M_2^c &= \frac{M_2}{1 + 3 \sigma_\omega^2 / \bar{\omega}^2}, \\
M_3^c &= \frac{M_3}{1 + 1 \sigma_\omega^2 / \bar{\omega}^2}, \\
M_4^c &= M_4 \quad (\text{no correction needed}), \\
M_{-1}^c &= \frac{M_{-1}}{1 + 6 \sigma_\omega^2 / \bar{\omega}^2}.
\end{align}

All higher-level corrected metrics (periods, heights, bandwidths, counts, skew/kurtosis, energy flux) are computed consistently from $M_n^c$.

\subsection{Interpretation}

Bias correction reduces spurious inflation of variance-related metrics (e.g. $H_s$, $T_z$, RBW) under jittery frequency tracking or accelerometer DC offset.  
It ensures stable trends in noisy field conditions.

\section{Summary of Metrics}

Table~\ref{tab:metrics} summarizes the key metrics implemented in
\texttt{SeaMetrics}, their physical meaning, and typical usage in
oceanography.

\renewcommand{\arraystretch}{1.2}
\begin{longtable}{|l|l|p{8cm}|}
\caption{Summary of metrics computed by \texttt{SeaMetrics}.} \label{tab:metrics} \\
\hline
\textbf{Metric} & \textbf{Symbol} & \textbf{Physical meaning / use} \\
\hline
\endfirsthead
\hline
\textbf{Metric} & \textbf{Symbol} & \textbf{Physical meaning / use} \\
\hline
\endhead
\hline
\endfoot
\hline
\endlastfoot
Zeroth moment & $M_0$ & Total variance of displacement; proportional to wave energy. \\
First moment & $M_1$ & Energy-weighted frequency; defines mean wave frequency. \\
Second moment & $M_2$ & Energy-weighted squared frequency; controls upcrossing rate. \\
Third, fourth moments & $M_3, M_4$ & Higher-order spectral shape information (skewness, kurtosis). \\
Negative moment & $M_{-1}$ & Defines energy flux and mean wave energy period. \\
\hline
Mean frequency & $\bar{\omega}, \bar{f}$ & Central frequency of sea state in rad/s or Hz. \\
RBW & $\sqrt{\mu_2}/\bar{\omega}$ & Dimensionless measure of spectral width. \\
Phase RBW & Var$(\Delta \phi / \Delta t)$ & Alternative bandwidth estimate from phase increments. \\
\hline
Zero-crossing period & $T_z$ & Average time between successive zero crossings. \\
Energy period & $T_e$ & Period linked to wave energy transport. \\
Mean period & $T_1, T_{m02}$ & Alternative averages; used in design formulas. \\
Group period & $T_g$ & Average spacing of wave groups. \\
Upcrossing rate & $\nu_\uparrow$ & Average number of waves per second. \\
\hline
Significant wave height & $H_s$ & Standard design height, $H_s \approx 4\sigma$. \\
RMS displacement & $\sigma$ & Standard deviation of surface elevation. \\
Steepness & $H_s/L_0$ & Nonlinearity indicator; $>0.05$ implies steep waves. \\
\hline
Bandwidths & CLH, Goda, Kuik, LH & Classical measures of spectral width/spread. \\
Regularity & $R_{\text{spec}}, R_{\text{phase}}$ & Measures of coherence vs. randomness. \\
Narrowness & $\nu$ & Alternative compactness measure. \\
\hline
Crest exceedance & $P(H_c>h)$ & Probability a crest exceeds $h$ (Rayleigh or Tayfun). \\
Extreme crests & $H_{1/10}, H_{1/100}$ & Expected high crests in 10 or 100 waves. \\
Benjamin–Feir Index & BFI & Instability index for modulational instability. \\
Groupiness factor & $G$ & Ratio of group to zero-crossing period. \\
\hline
Energy flux period & $T_{e,\text{flux}}$ & Period relevant to wave energy transport. \\
Wave power & $P$ & Mean wave energy flux per unit crest length. \\
Wave energy density & $E$ & Energy content per unit surface area. \\
\hline
Ursell number & $Ur$ & Balance of nonlinearity vs. dispersion in finite depth. \\
Nonlinearity parameter & $n$ & Spectral steepness $0.5H_sk$. \\
Wave age & $c_p/U_{10}$ & Maturity of wind sea vs. swell. \\
\hline
Breaking probability & $P_b$ & Probability of wave breaking (depth or steepness). \\
Breaking height & $H_b$ & Depth-limited crest height, $\approx 0.78 h$. \\
\hline
MSDV & -- & Motion Sickness Dose Value, ISO-based exposure index. \\
Seasickness incidence & -- & Predicted percentage affected during exposure. \\
Comfort rating & -- & Heuristic 0--100 scale based on MSDV. \\
Time to onset & -- & Approximate time until discomfort occurs. \\
\hline
\end{longtable}

\begin{thebibliography}{9}
\bibitem{Cartwright1956}
D. E. Cartwright and M. S. Longuet-Higgins,
\textit{The statistical distribution of the maxima of a random function},
Proc. R. Soc. Lond. A, 237(1209):212–232, 1956.

\bibitem{Longuet1963}
M. S. Longuet-Higgins,
\textit{The effect of non-linearities on statistical distributions in the theory of sea waves},
J. Fluid Mech., 17(3):459–480, 1963.

\bibitem{Goda1970}
Y. Goda,
\textit{Numerical experiments on wave statistics with spectral simulation},
Rep. Port Harbour Res. Inst., 9(3):3–57, 1970.

\bibitem{Kuik1988}
A. J. Kuik, G. P. van Vledder, and L. H. Holthuijsen,
\textit{A method for the routine analysis of pitch-and-roll buoy wave data},
J. Phys. Oceanogr., 18:1020–1034, 1988.

\bibitem{Tayfun1980}
M. A. Tayfun,
\textit{Narrow-band nonlinear sea waves},
J. Geophys. Res., 85(C3):1548–1552, 1980.

\bibitem{Ochi1998}
M. K. Ochi,
\textit{Ocean Waves: The Stochastic Approach},
Cambridge Univ. Press, 1998.

\bibitem{Battjes1978}
J. A. Battjes and J. P. F. M. Janssen,
\textit{Energy loss and set-up due to breaking of random waves},
Coastal Engineering, 1(1):23--40, 1978.

\bibitem{ISO2631}
International Organization for Standardization,
\textit{ISO 2631-1: Mechanical vibration and shock -- Evaluation of human exposure to whole-body vibration},
ISO, 1997.

\bibitem{BenjaminFeir1967}
T. B. Benjamin and J. E. Feir,
\textit{The disintegration of wave trains on deep water. Part 1. Theory},
J. Fluid Mech., 27(3):417--430, 1967.
\end{thebibliography}

\end{document}
