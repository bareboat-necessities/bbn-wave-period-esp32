\documentclass[10pt]{extarticle}
\usepackage{amsmath, amssymb, amsfonts, bm}
\usepackage{geometry, setspace}
\usepackage{hyperref}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{titlesec}
\usepackage{nccmath, relsize}
\usepackage{array, booktabs, makecell, adjustbox}
\usepackage{mathtools}
\usepackage{amsthm}        % enables theorem/lemma environments
\newtheorem{lemma}{Lemma}  % defines what a "lemma" is
\newtheorem*{theorem*}{Theorem}

\newcommand{\Skew}[1]{\left[#1\right]_\times}  % skew-symmetric operator
\newcommand{\Id}{\mathbf{I}}

% Make inline math slightly smaller
\everymath{\smaller}

% Make display equations typeset in \small
\everydisplay\expandafter{\the\everydisplay\small}

% Reduce spacing before/after headings
\titlespacing*{\section}{0pt}{1.0ex plus .2ex}{0.6ex}
\titlespacing*{\subsection}{0pt}{0.8ex plus .2ex}{0.4ex}
\titlespacing*{\subsubsection}{0pt}{0.6ex plus .2ex}{0.3ex}

% Make section fonts smaller (like textbooks)
\titleformat{\section}{\normalfont\small\bfseries}{\thesection}{0.8em}{}
\titleformat{\subsection}{\normalfont\small\itshape}{\thesubsection}{0.8em}{}
\titleformat{\subsubsection}{\normalfont\footnotesize\itshape}{\thesubsubsection}{0.8em}{}

\geometry{letterpaper, margin=0.65in}
\setstretch{0.95}

\title{A Multiplicative EKF with Latent OU Acceleration for Drift-Robust Wave Kinematics: \\
Theory, Discretization, and Bias Compensation}
\author{Mikhail Grushinskiy}
\date{2025}

\begin{document}
\maketitle

\begin{abstract}
We present a detailed mathematical development of a quaternion multiplicative EKF (MEKF) fused with an extended 
linear kinematic chain for ocean-wave motion estimation. 
The method augments attitude (with optional gyroscope and accelerometer bias) by the linear states velocity $\bm v$, displacement $\bm p$, 
and the integral of displacement $\bm S$, driven by a \emph{latent} world-frame acceleration $\bm a_w$ modeled as an Ornstein--Uhlenbeck (OU) process. The OU prior confers stationary variance and realistic temporal correlation for the latent acceleration, which slows the drift growth in integrated states compared to white-noise forcing. It does not strictly bound the variance of integrated displacement, but ensures covariance growth of displacement is polynomially slower and numerically manageable.
Biases are explicitly modeled: gyroscope bias as a random walk, accelerometer bias both as random walk and as systematic temperature-dependent drift. 
A pseudo-measurement is introduced on $\bm S$ to control double integral divergence. 
We derive continuous- and discrete-time process models, show Rodrigues and Analytic discretizations, and derive explicit Jacobians for accelerometer and magnetometer updates. 
Finally, we discuss tuning strategies and the prospect of adaptive parameter estimation.
\end{abstract}

\tableofcontents
\newpage

% === CORE SECTIONS ===
\input{w3d-intro.tex-part}        % Introduction and motivation
\input{w3d-state.tex-part}        % State definition and notation
\input{w3d-meas.tex-part}         % Unified measurement model + Joseph form update
\input{w3d-proc-cont.tex-part}         % Continuous process model
\input{w3d-lti-discrete.tex-part}         % Continuous process model
%\input{w3d-proc.tex-part}         % Continuous process model
\input{w3d-analytic-coeff.tex-part}
%\input{w3d-tupdate.tex-part}      % Time-update (attitude + linear propagation)
\input{w3d-kalm-up.tex-part} 
\input{w3d-init.tex-part}         % Initialization & warm-up

% === ANALYTIC DISCRETIZATION AND COVARIANCE STRUCTURE ===
%\input{w3d-analytic.tex-part}     % Canonical OU discretization (Φ, Q, series)
%  → Replaces w3d-ou12.tex-part, w3d-ou-coeff.tex-part, w3d-dnoise.tex-part
%\input{w3d-analytic-lap.tex-part}

\input{w3d-cross-cov.tex-part}    % Cross-covariance + Joseph form + PSD projection
%  → Replaces w3d-propag.tex-part and w3d-joseph.tex-part

%\input{w3d-riccati.tex-part}      % Continuous→discrete Riccati mapping

% === JACOBIANS ===
%\input{w3d-jacobian.tex-part}     % Process Jacobians
%\input{w3d-jac-attitude.tex-part} % Attitude linearization
%\input{w3d-jac-meas.tex-part}     % Measurement Jacobians
%  → w3d-jac-ag.tex-part removed (duplicate merge)

% === ORIENTATION HANDLING ===
%\input{w3d-quat.tex-part}         % Quaternion correction & normalization
%  → Replace duplication in w3d-tupdate.tex-part

% === OU APPENDICES ===
%\input{w3d-ou-q.tex-part}         % OU covariance kernel & primitives
%  → Merge w3d-ou-kern.tex-part here

\input{w3d-lyap.tex-part}

\section{Symbolical Derivations}

\input{w3d-phi-symb.tex-part}
\input{w3d-qd-symb.tex-part}
\input{w3d-qd-symb-lap.tex-part}
\input{w3d-phi-A-symb.tex-part}
\input{w3d-qd-A-symb.tex-part}
\input{w3d-proc-symb-assembly.tex-part}

% === END ===
\end{document}
