\documentclass[conference]{IEEEtran}

% Core packages
\usepackage{iftex}
\ifPDFTeX
  \usepackage[utf8]{inputenc}
  \usepackage[T1]{fontenc}
\fi
\usepackage{newtxtext,newtxmath} % Times-like text + math (IEEE-style)
\usepackage{textcomp}

\usepackage{amsmath, bm}
\interdisplaylinepenalty=2500 % allow page breaks in multiline equations
\usepackage{pgf}
\usepackage{pgfplots}
\usepackage{float}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage{placeins} % for \FloatBarrier
\usepackage{array, booktabs, makecell, adjustbox}
\usepackage{mathtools}
\usepackage{nccmath, relsize}
\usepackage{enumitem}
\usepackage{amsthm}
\usepackage{balance} % balance final page columns
\usepackage{flafter} % figures/tables won’t appear before they’re defined
\usepackage{siunitx}
\usepackage[final]{microtype}   % better spacing/hyphenation
\usepackage{etoolbox}

\let\Bbbk\relax
\usepackage{amssymb}

\usepackage{cite}
\usepackage[breaklinks=true,hidelinks]{hyperref}
\usepackage{bookmark}
\usepackage[nameinlink,capitalise,noabbrev]{cleveref}

\sisetup{
  detect-weight = true,
  detect-family = true,
  per-mode = symbol,
}

% Description labels small & bold
\setlist[description]{font=\footnotesize\bfseries, labelsep=0.6em, leftmargin=1.8em}

% Make math/siunitx safe in PDF bookmarks
\pdfstringdefDisableCommands{%
  \def\SI#1#2{#1 #2}%
  \def\bm#1{#1}%
  \def\Skew#1{[#1]_\text{x}}%
  \def\Id{I}%
  \def\pct#1{#1\%}%
  \def\circ{deg}%
  \def\degree{deg}% siunitx \degree if it leaks into bookmarks
  \def\propto{∝}%
  \def\sigma{sigma}%
  \def\tau{tau}%
  \def\Phi{Phi}%
  \def\omega{omega}%
  \def\_{}%
  \def\cdot{}%
  \def\;{ }%
}

\AtBeginEnvironment{equation}{\small}
\AtBeginEnvironment{align}{\small}

% Needed by PGF outputs that reference \mathdefault
\providecommand{\mathdefault}[1]{#1}

% Unicode punctuation mappings (pdfLaTeX)
\DeclareUnicodeCharacter{2013}{\textendash}        % –
\DeclareUnicodeCharacter{2014}{\textemdash}        % —
\DeclareUnicodeCharacter{2018}{\textquoteleft}     % ‘
\DeclareUnicodeCharacter{2019}{\textquoteright}    % ’
\DeclareUnicodeCharacter{201C}{\textquotedblleft}  % “
\DeclareUnicodeCharacter{201D}{\textquotedblright} % ”
\DeclareUnicodeCharacter{2212}{\textminus}         % − (math minus)

% Theorems: small header/body
\newtheoremstyle{bodysmall}
  {3pt}{3pt}{\normalfont\small}{0pt}{\bfseries\small}{.}{0.5em}{}
\theoremstyle{bodysmall}
\newtheorem{lemma}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem*{theorem*}{Theorem}

% Shortcuts
\newcommand{\Skew}[1]{\left[#1\right]_\times}
\newcommand{\Id}{\mathbf{I}}
\newcommand{\pct}[1]{#1\%}
\newcommand{\meanstd}[2]{#1 \pm #2}
% or
% \newcommand{\meanstd}[2]{#1\,{\scriptsize$\pm$}\,#2}
\newcommand{\ci}[2]{#1\,(\,#2\,\text{CI}\,)}

% Itô integral
\newcommand{\Ito}{\mathrm{It\hat{o}}}
\newcommand{\ItoInt}[2]{\int_0^{#1} #2\, dW_s^{\Ito}}

\DeclareMathOperator{\proj}{\mathcal{P}}
\DeclareMathOperator{\clip}{clip}
\DeclareMathOperator{\wrap}{wrap}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\blkdiag}{blkdiag}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\sym}{sym}

% Two-column helper (no layout change)
\newcommand{\fitcol}[1]{\adjustbox{max width=\columnwidth}{$\displaystyle #1$}}

\makeatletter
\@ifpackageloaded{cite}{%
  \renewcommand{\citepunct}{,\penalty\citepunctpenalty\,}%
  \renewcommand{\citedash}{--}%
}{}
\makeatother

% Allow multi-line displays to break across columns
\emergencystretch=2em
\allowdisplaybreaks

% Title & authors (IEEEtran conference style)
\title{A Multiplicative EKF with Latent OU Acceleration for Drift-Robust Wave Kinematics:\\
Theory, Discretization, and Bias Compensation}

\author{%
\IEEEauthorblockN{Mikhail S. Grushinskiy}
\IEEEauthorblockA{Independent Researcher\\
Bareboat Necessities GitHub Project\\
Email: mgrouch@users.github.com}%
}

\pgfplotsset{compat=1.18}

\begin{document}
\maketitle

\begin{abstract}
We present a detailed mathematical development of a quaternion multiplicative extended Kalman filter fused with an extended
linear kinematic chain for ocean-wave motion estimation. The method augments attitude, with optional gyroscope and
accelerometer bias, by linear velocity, displacement, and the integral of displacement, driven by a latent world-frame
acceleration modeled as an Ornstein--Uhlenbeck process. The Ornstein--Uhlenbeck prior provides stationary variance and
realistic temporal correlation for the latent acceleration, which slows the growth of drift in integrated states compared
with white-noise forcing. It does not strictly bound the variance of integrated displacement, but it ensures that covariance
growth of displacement is polynomially slower and numerically manageable. Biases are explicitly modeled: gyroscope bias as a
random walk and accelerometer bias as both random walk and systematic temperature-dependent drift. A pseudo-measurement is
introduced on the integral of displacement to control double-integral divergence. We derive continuous-time and discrete-time
process models, present Rodrigues and analytic discretizations, and give explicit Jacobians for accelerometer and
magnetometer updates. Finally, we discuss tuning strategies and the prospect of adaptive parameter estimation.
\end{abstract}

\begin{IEEEkeywords}
extended Kalman filter, inertial navigation, wave kinematics, Ornstein--Uhlenbeck process, OCEANS
\end{IEEEkeywords}

% === CORE SECTIONS ===
\input{w3d-intro.tex-part}
\input{w3d-state.tex-part}
\input{w3d-meas.tex-part}
\input{w3d-proc-cont.tex-part}
\input{w3d-lti-discrete.tex-part}
%\input{w3d-proc.tex-part}
\input{w3d-analytic-coeff.tex-part}
%\input{w3d-tupdate.tex-part}
\input{w3d-kalm-up.tex-part}
\input{w3d-init.tex-part}

% === ANALYTIC DISCRETIZATION AND COVARIANCE STRUCTURE ===
%\input{w3d-analytic.tex-part}
%\input{w3d-analytic-lap.tex-part}

%\input{w3d-cross-cov.tex-part}
%\input{w3d-riccati.tex-part}

% === JACOBIANS ===
%\input{w3d-jacobian.tex-part}
%\input{w3d-jac-attitude.tex-part}
%\input{w3d-jac-meas.tex-part}

% === ORIENTATION HANDLING ===
%\input{w3d-quat.tex-part}

% === OU APPENDICES ===
%\input{w3d-ou-q.tex-part}

%\input{w3d-lyap.tex-part}

%\section{Symbolical Derivations}
%\input{w3d-phi-symb.tex-part}
%\input{w3d-qd-symb.tex-part}
%\input{w3d-qd-symb-lap.tex-part}
%\input{w3d-phi-A-symb.tex-part}
%\input{w3d-qd-A-symb.tex-part}
%\input{w3d-proc-symb-assembly.tex-part}

\input{fus-methods.tex-part}

%\input{sim-results.tex-part}
\input{sim-charts.tex-part}

% Balance final page columns (optional, IEEE-style)
\balance

\bibliographystyle{IEEEtran}
%\bibliography{yourbibfile}

\end{document}
