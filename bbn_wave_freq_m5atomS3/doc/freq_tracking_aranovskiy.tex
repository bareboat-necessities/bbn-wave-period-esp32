\documentclass{article}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{graphicx}

\title{Comprehensive Analysis of Aranovskiy Frequency Estimator}
\author{}
\date{}

\begin{document}

\maketitle

\section{Theoretical Foundations}

\subsection{Original Reference}
The algorithm is based on the work of Bobtsov~\cite{Bobtsov2013}, which introduced an adaptive, amplitude-independent estimator for quasi-sinusoidal signals.

\subsection{Oscillator Model and Order}
We assume the measured signal \(y(t)\) is generated by a second-order self-oscillating observer driven by the input:
\begin{equation}
\ddot{z}(t) + 2 a \dot{z}(t) + a^2 z(t) = b\,y(t),
\end{equation}
where
\begin{itemize}
  \item \(z(t)\) is the oscillator’s internal state,
  \item \(a>0\) is the bandwidth (damping) parameter,
  \item \(b>0\) is the input scaling.
\end{itemize}
Defining
\[
x_1 = z,\quad x_2 = \dot z,
\]
this yields a second–order observer.  The “energy” of this oscillator is
\begin{equation}
E = \tfrac12 x_2^2 + \tfrac12 a^2 x_1^2,
\end{equation}
which decays under the damping term \(2a\dot z\).  The adaptive law modulates its effective frequency so that the oscillator’s phase locks onto that of \(y(t)\).

\subsection{Signal Model}
The estimator treats the measurement as
\begin{equation}
y(t) = A(t)\,\sin\bigl(\omega(t)\,t + \phi(t)\bigr) + \nu(t),
\end{equation}
with
\begin{itemize}
  \item \(A(t)\): slowly varying amplitude (\(|\dot A/A|\ll\omega\)),
  \item \(\omega(t)\): unknown instantaneous frequency,
  \item \(\phi(t)\): unknown instantaneous phase,
  \item \(\nu(t)\): zero-mean measurement noise.
\end{itemize}
Key characteristics:
\begin{itemize}
  \item \textbf{Amplitude-independent}: No explicit \(A(t)\) estimation.
  \item \textbf{Frequency tracking}: Designed for \(\omega(t)\) variation.
\end{itemize}

\section{Discrete-Time Algorithm}

\subsection{Derivation of the Update Equations}
Starting from the continuous-time observer
\[
\dot x_1 = x_2,\quad
\dot x_2 = -a\,x_2 - a^2\,x_1 + b\,y,
\]
we apply forward Euler with step \(\Delta t\):
\begin{align}
x_1[n+1] &= x_1[n] + x_2[n]\,\Delta t, \label{eq:x1_disc}\\
x_2[n+1] &= x_2[n] + \bigl(-a\,x_2[n] - a^2\,x_1[n] + b\,y[n]\bigr)\Delta t.
\end{align}

The adaptive frequency parameter \(\sigma\) (which tracks \(\omega^2\)) evolves via:
\begin{align}
\sigma[n+1] &= \sigma[n] + \dot{\sigma}[n]\,\Delta t, \label{eq:sigma_disc}\\
\dot{\sigma}[n] 
  &= \mathrm{clamp}\Bigl(-k\,x_1[n]\,\theta[n] 
     \;-\; k\,a\,x_1[n]\,\dot{x}_1[n] 
     \;-\; k\,b\,\dot{x}_1[n]\,y[n],\;\sigma_{\max}\Bigr),\nonumber
\end{align}
where
\[
\theta[n] = \sigma[n] + k\,b\,x_1[n]\,y[n],
\quad
\dot{x}_1[n] \approx \frac{x_1[n] - x_1[n-1]}{\Delta t},
\]
and
\[
\omega[n] = \sqrt{\max\bigl(|\theta[n]|,\;\omega_{\min}^2\bigr)},
\quad
\phi[n] = \arctan\!\bigl(\tfrac{x_1[n]}{y[n]}\bigr).
\]
Here
\(\mathrm{clamp}(u,M)=\max(-M,\min(M,u))\).  

\subsection{Amplitude Robustness Mechanism}
Because the adaptation law is based on normalized gradients, at steady state
\[
\frac{\partial \dot{\sigma}}{\partial A} = 0,
\]
since all \(A^2\) terms cancel in the update.  Thus the estimator is:
\begin{itemize}
  \item Insensitive to slow amplitude changes.
  \item Stable for \(A(t)\) variations satisfying \(|\dot{A}/A|\ll\omega\).
\end{itemize}

\subsection{Explanation of Unexplained Variables}
\begin{itemize}
  \item \(x_1, x_2\): internal states of the observer (position and velocity).
  \item \(\sigma\): estimate of \(\omega^2\).
  \item \(\theta\): intermediate variable combining \(\sigma\) and the innovation \(k\,b\,x_1\,y\).
  \item \(k\): adaptation gain (tunes convergence speed).
  \item \(\omega_{\min}\): lower bound to prevent singularity.
  \item \(\sigma_{\max}\): clamp limit to avoid numerical overflow.
\end{itemize}

\section{Stability and Convergence}

\subsection{Energy-Based Lyapunov Analysis}
Define the errors
\[
e_x = x_1 - x_{1,\mathrm{ref}}, 
\quad
e_\omega = \omega^2 - \theta,
\]
and candidate Lyapunov function
\[
V = \tfrac12\,e_x^2 + \tfrac12\,e_\omega^2.
\]
Differentiation yields
\[
\dot{V} = -a\,e_x^2 \;-\; k\,b^2\,x_1^2\,e_\omega^2 \;\le 0,
\]
so the combined “energy” in state and frequency errors decays monotonically.

\subsection{Convergence Speed}
One shows exponential decay:
\[
\|e(t)\|\le \|e(0)\|\,e^{-\lambda t},\quad
\lambda = \min\bigl(a,\;k\,b^2\,A^2/4\bigr).
\]

\subsection{Phase Convergence}
The phase error appears in the cross-term \(x_1\,y\).  The adaptation drives 
\(\sin(\phi-\phi_{\mathrm{true}})\) toward zero, so in steady state
\[
\phi[n]\to\phi_{\mathrm{true}}\quad (\bmod\ \pi),
\]
i.e.\ both frequency and phase lock.

\begin{table}[h]
\centering
\caption{Parameter Effects Summary}
\begin{tabular}{lll}
Parameter       & Role               & Effect on Convergence            \\
\hline
$a$              & State bandwidth    & Faster for larger \(a\)          \\
$b$              & Input scaling      & Balances noise/gain              \\
$k$              & Adaptation gain    & Proportional to convergence rate \\
$\omega_{\min}$ & Numerical safety   & Prevents singularity             \\
\end{tabular}
\end{table}

\section{Numerical Implementation}

\subsection{Critical Considerations}
\begin{itemize}
  \item \textbf{Clamping}: Essential for \(\dot{\sigma}\) to prevent overflow  
  \[
    \sigma_{\max} = 10^7,\quad \omega_{\min}^2 = 10^{-10}.
  \]
  \item \textbf{Initial Conditions}:
  \[
    \theta(0) = -\frac{\omega_{\max}^2}{4}
    \quad\text{(ensures real \(\omega\) during transients)}.
  \]
  \item \textbf{Step Size}:
  \[
    \Delta t \le \frac{1}{2a}
    \quad\text{(stability condition for Euler discretization)}.
  \]
\end{itemize}

\section{Amplitude Variation Performance}

The estimator’s amplitude robustness stems from:
\begin{itemize}
  \item Normalized gradient in \(\dot{\sigma}\).
  \item Cancellation of \(A\)-terms in steady state.
  \item Phase-based rather than amplitude-based updates.
\end{itemize}

Compared to PLL methods, one finds approximately
\[
\mathrm{SNR}_{\text{Aran}} 
\approx \mathrm{SNR}_{\text{PLL}} 
+ 10\log_{10}\!\Bigl(\tfrac{k}{2\pi}\Bigr)
\quad\text{(dB)},
\]
for equivalent amplitude-rejection performance.

\begin{thebibliography}{9}
\bibitem{Bobtsov2013}
Alexey A. Bobtsov, Nikolay A. Nikolaev, Olga V. Slita, Alexander S. Borgul, and Stanislav V. Aranovskiy, 
``The New Algorithm of Sinusoidal Signal Frequency Estimation,'' 
in \emph{11th IFAC International Workshop on Adaptation and Learning in Control and Signal Processing}, 
Caen, France, 2013.
\end{thebibliography}

\end{document}
